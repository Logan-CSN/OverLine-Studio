<!DOCTYPE html>
              <html lang="en">
              <head>
              <meta charset="UTF-8" />
              <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
              <title>Graphics Output</title>
              <style>
                /* ------------------------
                   Base
                   ------------------------ */
                html, body {
                  margin: 0;
                  padding: 0;
                  background: transparent;
                  height: 100%;
                  width: 100%;
                  overflow: hidden;
                  font-family: Impact, Charcoal, sans-serif;
                  user-select: none;
                  color: #fff;
                }
                body {
                  position: relative;
                  height: 100%;
                  width: 100%;
                }

                /* ------------------------
                   Scorebar (with animation support)
                   ------------------------ */
                .scorebar {
                  position: absolute;
                  bottom: 69px; /* moved down 2px */
                  left: 50%;
                  transform: translateX(-50%);
                  display: inline-flex;
                  max-width: 1600px;
                  height: 60px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  z-index: 9999;
                  box-shadow: inset 0 0 20px #0009;
                  white-space: nowrap;
                }

                /* Flag Overlay - invisible overlay spanning clock and down & distance */
                .flag-overlay {
                  position: absolute;
                  bottom: 69px;
                  left: calc(50% + 148px);
                  transform: translateX(-50%);
                  margin-left: 390px; /* Position to cover clock and football section */
                  width: 270px; /* Width to cover both clock (120px) + separator (4px) + football section (150px) */
                  height: 60px;
                  background: transparent; /* Invisible background */
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  z-index: 10002;
                  opacity: 1;
                  pointer-events: none; /* Allow clicks to pass through */
                  box-sizing: border-box;
                  overflow: hidden;
                }

                /* Container that holds both gradient + text */
                .flag-pulse {
                  position: absolute;
                  inset: 0;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background: linear-gradient(#FFD400, #FFA500);;
                  transform: scale(0);
                  opacity: 0;
                  pointer-events: none;
                  border-radius: inherit;
                }

                .flag-pulse span {
                  font-size: 42px;
                  font-weight: 400;
                  color: black;
                  user-select: none;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* Animations */
                @keyframes pulseIn {
                  from { transform: scale(0); opacity: 0; }
                  to   { transform: scale(1); opacity: 1; }
                }

                @keyframes pulseOut {
                  from { transform: scale(1); opacity: 1; }
                  to   { transform: scale(2); opacity: 0; }
                }

                .flag-animate-in {
                  animation: pulseIn 0.35s ease-out forwards;
                }

                .flag-animate-out {
                  animation: pulseOut 0.45s ease-in forwards;
                }

                .flag-visible {
                  transform: scale(1);
                  opacity: 1;
                }

                .scorebar.hidden {
                  transform: translateX(-50%) translateY(150px);
                  opacity: 0;
                  pointer-events: none;
                }

                .scorebar::before {
                  content: "";
                  position: absolute;
                  top: -4px;
                  left: -15px;
                  right: -15px;
                  height: calc(100% + 8px);
                  border: 4px solid #808080;
                  border-radius: 12px;
                  z-index: 10000;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .vertical-bar-left,
                .vertical-bar-right {
                  position: absolute;
                  top: 0;
                  height: 60px;
                  width: 4px;
                  background-color: #808080;
                  pointer-events: none;
                  z-index: 20;
                }
                .vertical-bar-left { left: 0; }
                .vertical-bar-right { right: 0; }

                .separator {
                  height: 60px;
                  width: 4px;
                  background-color: #808080;
                  pointer-events: none;
                  flex-shrink: 0;
                  z-index: 10;
                }

                .scorebar > div {
                  display: flex;
                  align-items: center;
                  height: 60px;
                  margin: 0;
                  padding: 0;
                }

                .home-wrapper, .away-wrapper {
                  display: flex;
                  margin: 0;
                  padding: 0;
                  align-items: center;
                }

                .team-color-strip {
                  width: 4px;
                  height: 60px;
                  flex-shrink: 0;
                  pointer-events: none;
                }

                .color-square {
                  width: 70px;
                  height: 60px;
                  position: relative;
                  overflow: hidden;
                }
                .color-square::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .color-square img {
                  position: relative;
                  max-height: 50px;
                  max-width: 65px;
                  object-fit: contain;
                  margin: auto;
                  display: block;
                  top: 50%;
                  transform: translateY(-50%);
                  pointer-events: none;
                  user-select: none;
                }

                .school-name {
                  background-color: rgba(0, 0, 0, 0);
                  color: #fff;
                  width: 330px;
                  text-align: left;
                  padding-left: 14px;
                  user-select: text;
                  height: 60px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  box-shadow: inset 0 3px 6px rgba(0,0,0,0.8);
                  box-sizing: border-box;
                  margin: 0;
                  text-transform: uppercase;
                  line-height: 1;
                }

                .team-name-text {
                  font-size: 18px;
                  line-height: 1;
                  margin: 0px 0px 0px -8px;
                  padding: 0;
                  flex-shrink: 0;
                  letter-spacing: 2px;
                }

                .school-mascot {
                  font-size: 35px;
                  margin: 1px 0px 0px -8px;
                  padding: 0;
                  line-height: 1;
                  text-transform: uppercase;
                  user-select: none;
                  flex-shrink: 0;
                  letter-spacing: 6px;
                }

                .score {
                  font-family: 'Oswald', sans-serif;
                  font-weight: 700;
                  font-size: 38px;
                  color: #000;
                  width: 70px;
                  height: 60px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background:
                    radial-gradient(circle at center, #fff 60%, #bbb 100%);
                  box-shadow:
                    inset 0 0 8px rgba(0, 0, 0, 0.5);
                  border: 1px solid #888;
                  user-select: none;
                  box-sizing: border-box;
                  padding: 0;
                  margin: 0;
                  vertical-align: middle;
                  position: relative;
                }

                .score-overlay {
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  opacity: 0;
                  transform: scale(0.8);
                  pointer-events: none;
                  z-index: 1000;
                  border: 1px solid #888;
                  box-sizing: border-box;
                }

                .score-overlay.animate {
                  animation: scoreSlate 1s ease-out forwards;
                }

                .score-overlay img {
                  max-height: 40px;
                  max-width: 55px;
                  object-fit: contain;
                  filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
                }

                @keyframes scoreSlate {
                  0% {
                    opacity: 0;
                    transform: scale(0.8);
                  }
                  15% {
                    opacity: 1;
                    transform: scale(1.1);
                  }
                  85% {
                    opacity: 1;
                    transform: scale(1);
                  }
                  100% {
                    opacity: 0;
                    transform: scale(0.9);
                  }
                }

                .period {
                  font-size: 25px;
                  font-family: 'Oswald', sans-serif;
                  font-weight: 900;
                  padding: 0 15px;
                  background:
                    linear-gradient(135deg, #3a3a3a 0%, #151515 100%);
                  color: #ffd90f;
                  width: 100px;
                  text-align: center;
                  height: 60px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  margin: 0;
                }

                .clock {
                  font-size: 25px;
                  font-family: 'Oswald', sans-serif;
                  font-weight: 900;
                  letter-spacing: 4px;
                  padding: 0 15px;
                  background:
                    linear-gradient(135deg, #3a3a3a 0%, #171717 100%);
                  color: #fff;
                  width: 120px;
                  text-align: center;
                  height: 60px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  margin: 0;
                }

                /* Hide clock and period in volleyball mode */
                .scorebar.volleyball-mode .period {
                  display: none;
                }

                .scorebar.volleyball-mode .clock {
                  display: none;
                }

                /* Hide separators around period and clock in volleyball mode */
                .scorebar.volleyball-mode .period + .separator {
                  display: none;
                }

                .scorebar.volleyball-mode .clock + .separator {
                  display: none;
                }

                /* Hide football-specific separators in volleyball mode */
                .scorebar.volleyball-mode .football-section-separator {
                  display: none;
                }

                /* Volleyball set section - hidden by default */
                .volleyball-set-section {
                  font-family: 'Oswald', sans-serif;
                  font-weight: 900;
                  font-size: 25px;
                  padding: 0 15px;
                  background: linear-gradient(135deg, #3a3a3a 0%, #151515 100%);
                  color: #ffd90f;
                  width: 220px;
                  text-align: center;
                  height: 60px;
                  display: none;
                  align-items: center;
                  justify-content: center;
                  margin: 0;
                  position: relative;
                  transition: width 0.3s ease, padding 0.3s ease;
                }

                /* Only show volleyball set section in volleyball mode */
                .scorebar.volleyball-mode .volleyball-set-section {
                  display: flex;
                }

                /* Ensure volleyball set section is hidden in all other modes */
                .scorebar:not(.volleyball-mode) .volleyball-set-section {
                  display: none !important;
                }

                /* Volleyball mode adjustments for lower scorebar elements */
                .lower-scorebar.first.volleyball-mode {
                  left: calc(50% - 594px);
                  width: 408px;
                }

                .lower-separator-left.volleyball-mode {
                  left: calc(50% - 598px);
                }

                .lower-separator-right.volleyball-mode {
                  left: calc(50% - 186px);
                }

                .lower-white-block.volleyball-mode {
                  left: calc(50% - 182px);
                }

                .lower-separator-right-2.volleyball-mode {
                  left: calc(50% - 112px);
                }

                .lower-scorebar.second.volleyball-mode {
                  left: calc(50% - 108px);
                  width: 408px;
                }

                .lower-separator-after-second.volleyball-mode {
                  left: calc(50% + 300px);
                }

                .lower-white-block.after-second.volleyball-mode {
                  left: calc(50% + 304px);
                }

                .lower-separator-after-white.volleyball-mode {
                  left: calc(50% + 374px);
                }

                .lower-scorebar.third.volleyball-mode {
                  left: calc(50% + 378px);
                  width: 220px;
                }

                .lower-separator-after-third.volleyball-mode {
                  left: calc(50% + 594px);
                }

                .football-section {
                  font-family: 'Oswald', sans-serif;
                  font-weight: 900;
                  background:
                    linear-gradient(135deg, #3a3a3a 0%, #171717 100%);
                  color: #fff;
                  width: 150px;
                  height: 60px;
                  display: flex;
                  align-items: center;
                  justify-content: space-around;
                  margin: 0;
                  padding: 0 10px;
                  box-sizing: border-box;
                  position: relative;
                }

                .football-combined {
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 8px;
                  font-size: 24px;
                  font-weight: 900;
                  color: #fff;
                  letter-spacing: 2px;
                  transition: opacity 0.3s ease;
                }

                .football-combined.hidden {
                  opacity: 0;
                }



                .football-ampersand {
                  font-size: 24px;
                  color: #fff;
                  font-weight: 900;
                  letter-spacing: 2px;
                }

                /* ------------------------
                   Lower scorebars (kept exactly where you had them)
                   ------------------------ */
                .lower-scorebar {
                  position: absolute;
                  bottom: 50px; /* moved down 2px */
                  width: 482px;
                  height: 15px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 10px #0009;
                  box-sizing: border-box;
                  z-index: 10005;
                  white-space: nowrap;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  padding: 0 8px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-scorebar.hidden,
                .lower-separator-left.hidden,
                .lower-separator-right.hidden,
                .lower-white-block.hidden,
                .lower-separator-right-2.hidden,
                .lower-separator-after-second.hidden,
                .lower-separator-after-white.hidden,
                .lower-separator-after-third.hidden {
                  transform: translateY(80px);
                  opacity: 0;
                  pointer-events: none;
                }

                .lower-scorebar.first {
                  left: calc(50% - 596px);
                  width: 408px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-scorebar.first.football-mode {
                  left: calc(50% - 673px);
                  width: 408px;
                }
                .lower-separator-left {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% - 600px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-left.football-mode {
                  left: calc(50% - 677px);
                }
                .lower-separator-right {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% - 188px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-right.football-mode {
                  left: calc(50% - 265px);
                }
                .lower-white-block {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% - 184px);
                  width: 70px;
                  height: 15px;
                  background: white;
                  box-sizing: border-box;
                  z-index: 10007;
                  overflow: hidden;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-white-block.football-mode {
                  left: calc(50% - 261px);
                }
                .lower-white-block::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .lower-separator-right-2 {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% - 114px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-right-2.football-mode {
                  left: calc(50% - 191px);
                }

                .lower-scorebar.second {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% - 110px);
                  width: 408px;
                  height: 15px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 10px #0009;
                  box-sizing: border-box;
                  z-index: 10005;
                  white-space: nowrap;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  padding: 0 8px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-scorebar.second.football-mode {
                  left: calc(50% - 187px);
                  width: 408px;
                }

                .lower-separator-after-second {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% + 298px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-after-second.football-mode {
                  left: calc(50% + 221px);
                }

                .lower-white-block.after-second {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% + 302px);
                  width: 70px;
                  height: 15px;
                  background: white;
                  box-sizing: border-box;
                  z-index: 10007;
                  overflow: hidden;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-white-block.after-second.football-mode {
                  left: calc(50% + 225px);
                }
                .lower-white-block.after-second::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .lower-separator-after-white {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% + 372px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-after-white.football-mode {
                  left: calc(50% + 295px);
                }

                .lower-scorebar.third {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% + 376px);
                  width: 220px;
                  height: 15px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f21);
                  box-shadow: inset 0 0 10px #0009;
                  box-sizing: border-box;
                  z-index: 10005;
                  white-space: nowrap;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, width 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-scorebar.third.football-mode {
                  left: calc(50% + 299px);
                  width: 375px;
                }

                .lower-separator-after-third {
                  position: absolute;
                  bottom: 50px;
                  left: calc(50% + 595px);
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  box-sizing: border-box;
                  pointer-events: none;
                  z-index: 10006;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease, left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .lower-separator-after-third.football-mode {
                  left: calc(50% + 674px);
                }

                /* ------------------------
                   Locator
                   ------------------------ */
                .locator-wrapper {
                  position: absolute;
                  bottom: 50px;
                  left: 0;
                  right: 0;
                  height: 125px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  z-index: 12000;
                  transform-origin: center center;
                }

                .locator-wrapper.hidden {
                  transform: scaleX(0);
                  opacity: 0;
                  pointer-events: none;
                }

                .locator {
                  position: absolute;
                  bottom: 25px;
                  left: 50%;
                  transform: translateX(-50%);
                  display: inline-flex;
                  width: 90%;
                  height: 100px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  white-space: nowrap;
                  z-index: 9502;
                }

                .locator-team-color-left,
                .locator-team-color-right {
                  position: absolute;
                  bottom: 25px;
                  width: 100px;
                  height: 100px;
                  z-index: 9503;
                  box-shadow: inset 0 0 20px #0009;
                }

                .locator-team-color-left {
                  left: calc(50% - 45%);
                  background-color: #c41e3a;
                }

                .locator-team-color-right {
                  right: calc(50% - 45%);
                  background-color: #006633;
                }

                .locator-team-color-strip-left,
                .locator-team-color-strip-right {
                  position: absolute;
                  bottom: 25px;
                  width: 4px;
                  height: 100px;
                  z-index: 9503;
                }

                .locator-team-color-strip-left {
                  left: calc(50% - 45% - 4px);
                  background-color: #c41e3a;
                }

                .locator-team-color-strip-right {
                  right: calc(50% - 45% - 4px);
                  background-color: #006633;
                }

                .locator-team-color-inner-strip-left,
                .locator-team-color-inner-strip-right {
                  position: absolute;
                  bottom: 25px;
                  width: 4px;
                  height: 100px;
                  z-index: 9504;
                }

                .locator-team-color-inner-strip-left {
                  left: calc(50% - 45% + 96px);
                  background-color: #c41e3a;
                }

                .locator-team-color-inner-strip-right {
                  right: calc(50% - 45% + 96px);
                  background-color: #006633;
                }

                .locator-team-logo {
                  position: absolute;
                  bottom: 25px;
                  width: 100px;
                  height: 100px;
                  z-index: 9504;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  pointer-events: none;
                }

                .locator-team-logo img {
                  max-height: 80px;
                  max-width: 80px;
                  object-fit: contain;
                  filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
                }

                .locator-team-logo-left {
                  left: calc(50% - 45%);
                }

                .locator-team-logo-right {
                  right: calc(50% - 45%);
                }

                .locator::before {
                  content: "";
                  position: absolute;
                  top: -4px;
                  left: -25px;
                  right: -25px;
                  height: calc(100% + 8px);
                  border: 4px solid #808080;
                  border-radius: 12px;
                  z-index: 15000;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .locator-separator-left,
                .locator-separator-right {
                  position: absolute;
                  bottom: 25px;
                  width: 4px;
                  height: 100px;
                  background-color: #808080;
                  z-index: 9499;
                }

                .locator-separator-left {
                  left: calc(50% - 45% - 8px);
                }

                .locator-separator-right {
                  right: calc(50% - 45% - 8px);
                }

                .locator-separator-middle {
                  position: absolute;
                  bottom: 25px;
                  left: 50%;
                  transform: translateX(-50%);
                  width: 4px;
                  height: 100px;
                  background-color: #808080;
                  z-index: 9901;
                }

                .locator-lower-separator-left,
                .locator-lower-separator-right {
                  position: absolute;
                  bottom: 0px;
                  width: 4px;
                  height: 25px;
                  background-color: #808080;
                  z-index: 9501;
                }

                .locator-lower-separator-left {
                  left: calc(50% - 45% - 8px);
                }

                .locator-lower-separator-right {
                  right: calc(50% - 45% - 8px);
                }

                .locator-lower {
                  position: absolute;
                  bottom: 0px;
                  left: calc(50% - 45% - 8px);
                  right: calc(50% - 45% - 8px);
                  height: 25px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 10px #0009;
                  z-index: 9500;
                }

                .locator-home-section,
                .locator-away-section {
                  position: absolute;
                  top: 0;
                  height: 100px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 9501;
                  pointer-events: none;
                }

                .locator-home-section {
                  position: absolute;
                  top: 0;
                  left: calc(50% - 45% + 40px);
                  right: calc(50% - 2px);
                  height: 100px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 9501;
                  pointer-events: none;
                  text-align: left;
                }

                .locator-away-section {
                  position: absolute;
                  top: 0;
                  left: calc(50% + 2px);
                  right: calc(50% - 45% + 40px);
                  height: 100px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 9501;
                  pointer-events: none;
                  text-align: right;
                }

                .locator-team-name {
                  font-size: 30px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 3px;
                  margin-bottom: -10px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                .locator-team-mascot {
                  font-size: 58px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 8px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* ------------------------
                   Mini Locator
                   ------------------------ */
                .mini-locator-wrapper {
                  position: absolute;
                  bottom: 50px;
                  left: 0;
                  right: 0;
                  height: 80px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  z-index: 11500;
                  transform-origin: center center;
                }

                .mini-locator-wrapper.hidden {
                  transform: scaleX(0);
                  opacity: 0;
                  pointer-events: none;
                }

                .mini-locator {
                  position: absolute;
                  bottom: 10px;
                  left: 50%;
                  transform: translateX(-50%);
                  display: inline-flex;
                  width: 35%;
                  height: 70px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  white-space: nowrap;
                  z-index: 11502;
                }

                .mini-locator-team-color-left {
                  position: absolute;
                  bottom: 12px;
                  left: calc(50% - 17.5%);
                  width: 70px;
                  height: 66px;
                  z-index: 11503;
                  box-shadow: inset 0 0 10px #0009;
                  background-color: #c41e3a;
                }

                .mini-locator-team-color-strip-left {
                  position: absolute;
                  bottom: 12px;
                  left: calc(50% - 17.5% - 4px);
                  width: 4px;
                  height: 66px;
                  z-index: 11503;
                  background-color: #c41e3a;
                }

                .mini-locator-team-color-inner-strip-left {
                  position: absolute;
                  bottom: 12px;
                  left: calc(50% - 17.5% + 66px);
                  width: 4px;
                  height: 66px;
                  z-index: 11504;
                  background-color: #c41e3a;
                }

                .mini-locator-team-logo {
                  position: absolute;
                  bottom: 10px;
                  width: 70px;
                  height: 70px;
                  z-index: 11504;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  pointer-events: none;
                }

                .mini-locator-team-logo img {
                  max-height: 60px;
                  max-width: 60px;
                  object-fit: contain;
                  filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
                }

                .mini-locator-team-logo img[src="../../IMAGES/CSN_logo.png"] {
                  max-height: 80px;
                  max-width: 80px;
                }

                .mini-locator-team-logo-left {
                  left: calc(50% - 17.5%);
                }

                .mini-locator::before {
                  content: "";
                  position: absolute;
                  top: -2px;
                  left: -20px;
                  right: -13px;
                  height: calc(100% + 4px);
                  border: 4px solid #808080;
                  border-radius: 6px;
                  z-index: 15500;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .mini-locator-separator-left {
                  position: absolute;
                  bottom: 10px;
                  left: calc(50% - 17.5% - 8px);
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11499;
                }

                .mini-locator-separator-right {
                  position: absolute;
                  bottom: 10px;
                  right: calc(50% - 17.5% - 4px);
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11499;
                }

                .mini-locator-lower-separator-left {
                  position: absolute;
                  bottom: 0px;
                  left: calc(50% - 17.5% - 8px);
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11501;
                }

                .mini-locator-lower-separator-right {
                  position: absolute;
                  bottom: 0px;
                  right: calc(50% - 17.5% - 4px);
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11501;
                }

                .mini-locator-lower {
                  position: absolute;
                  bottom: 0px;
                  left: calc(50% - 17.5% - 8px);
                  right: calc(50% - 17.5% - 4px);
                  height: 12px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 5px #0009;
                  z-index: 11500;
                }

                .mini-locator-home-section {
                  position: absolute;
                  top: 0;
                  left: calc(50% - 17.5% - 95px);
                  right: calc(50% + 1px);
                  height: 70px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 11501;
                  pointer-events: none;
                  text-align: left;
                }

                .mini-locator-team-name {
                  font-size: 18px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 1.5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                .mini-locator-team-mascot {
                  font-size: 38px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 4px;
                  margin-bottom: -5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* ------------------------
                   Talent Locator
                   ------------------------ */
                .talent-locator-wrapper {
                  position: absolute;
                  bottom: 50px;
                  left: 0;
                  right: 0;
                  height: 80px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  z-index: 11200;
                  transform-origin: center center;
                }

                .talent-locator-wrapper.hidden {
                  transform: scaleX(0);
                  opacity: 0;
                  pointer-events: none;
                }

                .talent-locator {
                  position: absolute;
                  bottom: 10px;
                  left: 150px;
                  display: inline-flex;
                  width: 550px;
                  height: 70px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  white-space: nowrap;
                  z-index: 11202;
                }

                .talent-locator-team-color-left {
                  position: absolute;
                  bottom: 12px;
                  left: 150px;
                  width: 70px;
                  height: 66px;
                  z-index: 11203;
                  box-shadow: inset 0 0 10px #0009;
                  background-color: #c41e3a;
                }

                .talent-locator-team-color-strip-left {
                  position: absolute;
                  bottom: 12px;
                  left: 146px;
                  width: 4px;
                  height: 66px;
                  z-index: 11203;
                  background-color: #c41e3a;
                }

                .talent-locator-team-color-inner-strip-left {
                  position: absolute;
                  bottom: 12px;
                  left: 216px;
                  width: 4px;
                  height: 66px;
                  z-index: 11204;
                  background-color: #c41e3a;
                }

                .talent-locator-team-logo {
                  position: absolute;
                  bottom: 10px;
                  width: 70px;
                  height: 70px;
                  z-index: 11204;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  pointer-events: none;
                }

                .talent-locator-team-logo img {
                  max-height: 60px;
                  max-width: 60px;
                  object-fit: contain;
                  filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
                }

                .talent-locator-team-logo img[src="../../IMAGES/CSN_logo.png"] {
                  max-height: 80px;
                  max-width: 80px;
                }

                .talent-locator-team-logo-left {
                  left: 150px;
                }

                .talent-locator::before {
                  content: "";
                  position: absolute;
                  top: -2px;
                  left: -18px;
                  right: -15px;
                  height: calc(100% + 4px);
                  border: 4px solid #808080;
                  border-radius: 6px;
                  z-index: 15500;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .talent-locator-separator-left {
                  position: absolute;
                  bottom: 10px;
                  left: 142px;
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11199;
                }

                .talent-locator-separator-right {
                  position: absolute;
                  bottom: 10px;
                  left: 700px;
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11199;
                }

                .talent-locator-lower-separator-left {
                  position: absolute;
                  bottom: 0px;
                  left: 142px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11201;
                }

                .talent-locator-lower-separator-right {
                  position: absolute;
                  bottom: 0px;
                  left: 700px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11201;
                }

                .talent-locator-lower {
                  position: absolute;
                  bottom: 0px;
                  left: 142px;
                  width: 558px;
                  height: 12px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 5px #0009;
                  z-index: 11200;
                }

                .talent-locator-home-section {
                  position: absolute;
                  top: 0;
                  left: 80px;
                  width: 470px;
                  height: 70px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 11201;
                  pointer-events: none;
                  text-align: left;
                }

                .talent-locator-team-name {
                  font-size: 18px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 1.5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                .talent-locator-team-mascot {
                  font-size: 38px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 4px;
                  margin-bottom: -5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* ------------------------
                   Talent Locator Right
                   ------------------------ */
                .talent-locator-right-wrapper {
                  position: absolute;
                  bottom: 50px;
                  left: 0;
                  right: 0;
                  height: 80px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  z-index: 11100;
                  transform-origin: center center;
                }

                .talent-locator-right-wrapper.hidden {
                  transform: scaleX(0);
                  opacity: 0;
                  pointer-events: none;
                }

                .talent-locator-right {
                  position: absolute;
                  bottom: 10px;
                  right: 150px;
                  display: inline-flex;
                  width: 550px;
                  height: 70px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  white-space: nowrap;
                  z-index: 11102;
                }

                .talent-locator-right-team-color-right {
                  position: absolute;
                  bottom: 12px;
                  right: 150px;
                  width: 70px;
                  height: 66px;
                  z-index: 11103;
                  box-shadow: inset 0 0 10px #0009;
                  background-color: #c41e3a;
                }

                .talent-locator-right-team-color-strip-right {
                  position: absolute;
                  bottom: 12px;
                  right: 146px;
                  width: 4px;
                  height: 66px;
                  z-index: 11103;
                  background-color: #c41e3a;
                }

                .talent-locator-right-team-color-inner-strip-right {
                  position: absolute;
                  bottom: 12px;
                  right: 216px;
                  width: 4px;
                  height: 66px;
                  z-index: 11104;
                  background-color: #c41e3a;
                }

                .talent-locator-right-team-logo {
                  position: absolute;
                  bottom: 10px;
                  width: 70px;
                  height: 70px;
                  z-index: 11104;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  pointer-events: none;
                }

                .talent-locator-right-team-logo img {
                  max-height: 60px;
                  max-width: 60px;
                  object-fit: contain;
                  filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
                }

                .talent-locator-right-team-logo img[src="../../IMAGES/CSN_logo.png"] {
                  max-height: 80px;
                  max-width: 80px;
                }

                .talent-locator-right-team-logo-right {
                  right: 150px;
                }

                .talent-locator-right::before {
                  content: "";
                  position: absolute;
                  top: -2px;
                  left: -15px;
                  right: -18px;
                  height: calc(100% + 4px);
                  border: 4px solid #808080;
                  border-radius: 6px;
                  z-index: 15500;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .talent-locator-right-separator-left {
                  position: absolute;
                  bottom: 10px;
                  right: 700px;
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11099;
                }

                .talent-locator-right-separator-right {
                  position: absolute;
                  bottom: 10px;
                  right: 142px;
                  width: 4px;
                  height: 70px;
                  background-color: #808080;
                  z-index: 11099;
                }

                .talent-locator-right-lower-separator-left {
                  position: absolute;
                  bottom: 0px;
                  right: 700px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11101;
                }

                .talent-locator-right-lower-separator-right {
                  position: absolute;
                  bottom: 0px;
                  right: 142px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11101;
                }

                .talent-locator-right-lower {
                  position: absolute;
                  bottom: 0px;
                  right: 142px;
                  width: 558px;
                  height: 12px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 5px #0009;
                  z-index: 11100;
                }

                .talent-locator-right-home-section {
                  position: absolute;
                  top: 0;
                  right: 80px;
                  width: 470px;
                  height: 70px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 11101;
                  pointer-events: none;
                  text-align: right;
                }

                .talent-locator-right-team-name {
                  font-size: 18px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 1.5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                .talent-locator-right-team-mascot {
                  font-size: 38px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 4px;
                  margin-bottom: -5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* ------------------------
                   TOUCHDOWN Animation
                   ------------------------ */
                .touchdown-logo {
                  position: fixed;
                  bottom: 40px;
                  left: -50px;
                  width: 350px;
                  height: 350px;
                  object-fit: contain;
                  z-index: 14900;
                  opacity: 0;
                  pointer-events: none;
                  transform: translateX(-400px);
                  transition: opacity 0.4s ease-out, transform 0.4s ease-out;
                }

                .touchdown-logo.show {
                  opacity: 0.8;
                  transform: translateX(0);
                }

                .touchdown-logo.hide {
                  opacity: 0;
                  transform: translateX(-400px);
                }

                #touchdownOutput {
                  position: fixed;
                  bottom: 100px;
                  left: 50px;
                  font-size: 72px;
                  font-weight: bold;
                  display: flex;
                  gap: 5px;
                  z-index: 15000;
                  font-family: Impact, Charcoal, sans-serif;
                  background: var(--touchdown-background-color, linear-gradient(135deg, #ff6b00, #ff4500)); /* Dynamic background */
                  -webkit-background-clip: text;
                  background-clip: text;
                  color: transparent; /* Make text transparent to show background */
                }
                .letter-wrapper {
                  position: relative;
                  display: inline-block;
                }
                .letter, .letter-outline {
                  display: inline-block;
                  opacity: 0;
                  transform: translateY(30px);
                }
                .letter {
                  color: white;
                  position: relative;
                  z-index: 2;
                }
                .letter-outline {
                  color: transparent;
                  -webkit-text-stroke: 3px var(--touchdown-stroke-color, blue);
                  position: absolute;
                  left: 4px;
                  top: 4px;
                  z-index: 1;
                }
                .letter.show, .letter-outline.show {
                  animation: slideUp 0.4s forwards;
                }
                .letter.animate-off, .letter-outline.animate-off {
                  animation: slideDown 0.4s forwards;
                }
                @keyframes slideUp {
                  0% { opacity: 0; transform: translateY(30px); }
                  60% { opacity: 1; transform: translateY(-10px); }
                  100% { opacity: 1; transform: translateY(0); }
                }
                @keyframes slideDown {
                  0% { opacity: 1; transform: translateY(0); }
                  40% { opacity: 1; transform: translateY(-10px); }
                  100% { opacity: 0; transform: translateY(30px); }
                }
                @keyframes bobUp {
                  0% { transform: translateY(0); }
                  60% { transform: translateY(-15px); }
                  100% { transform: translateY(0); }
                }
                @keyframes bounceUp {
                  0% { transform: translateY(0); }
                  50% { transform: translateY(-15px); }
                  100% { transform: translateY(0); }
                }
                .letter.bob-up, .letter-outline.bob-up {
                  animation: bobUp 0.4s forwards;
                }
                .letter.bounce-up, .letter-outline.bounce-up {
                  animation: bounceUp 0.5s forwards;
                }

                /* ------------------------
                   Tombstone
                   ------------------------ */
                .tombstone-wrapper {
                  position: absolute;
                  bottom: 50px;
                  left: 0;
                  right: 0;
                  height: 10px;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  z-index: 11400;
                  transform-origin: center center;
                }

                .tombstone-wrapper.hidden {
                  transform: scaleX(0);
                  opacity: 0;
                  pointer-events: none;
                }

                .tombstone {
                  position: absolute;
                  bottom: 10px;
                  left: 35px;
                  width: 400px;
                  height: 10px; /* Initial height */
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  letter-spacing: 1.2px;
                  align-items: center;
                  justify-content: flex-start;
                  gap: 0;
                  padding: 0;
                  box-sizing: border-box;
                  white-space: nowrap;
                  z-index: 11402;
                  overflow: visible; /* Ensure content is visible */
                }

                .tombstone-team-color-strip-left {
                  position: absolute;
                  top: -78px;
                  left: 35px;
                  width: 400px;
                  height: 4px;
                  z-index: 11403;
                  background-color: #c41e3a;
                }

                .tombstone-team-color-left {
                  position: absolute;
                  top: -74px;
                  left: 35px;
                  width: 400px;
                  height: 50px;
                  z-index: 11403;
                  box-shadow: inset 0 0 10px #0009;
                  background-color: #c41e3a;
                }

                .tombstone-team-color-inner-strip-left {
                  position: absolute;
                  top: -28px;
                  left: 35px;
                  width: 400px;
                  height: 4px;
                  z-index: 11404;
                  background-color: #c41e3a;
                }

                .tombstone-team-logo {
                  position: absolute;
                  top: -83px;
                  left: 35px;
                  width: 65px;
                  height: 65px;
                  z-index: 11404;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  pointer-events: none;
                }

                .tombstone-team-logo img {
                  max-height: 40px;
                  max-width: 40px;
                  object-fit: contain;
                  filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
                }

                .tombstone-team-logo img[src="../../IMAGES/CSN_logo.png"] {
                  max-height: 65px;
                  max-width: 65px;
                }

                .tombstone::before {
                  content: "";
                  position: absolute;
                  top: -2px;
                  left: -18px;
                  right: -15px;
                  height: calc(100% + 4px);
                  border: 4px solid #808080;
                  border-radius: 6px;
                  z-index: 15500;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .tombstone-separator-left {
                  position: absolute;
                  bottom: 10px;
                  left: 31px;
                  width: 4px;
                  height: 80px; /* Initial height */
                  background-color: #808080;
                  z-index: 11399;
                }

                .tombstone-separator-right {
                  position: absolute;
                  bottom: 10px;
                  left: 435px;
                  width: 4px;
                  height: 80px; /* Initial height */
                  background-color: #808080;
                  z-index: 11399;
                }

                .tombstone-lower-separator-left {
                  position: absolute;
                  bottom: 0px;
                  left: 31px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11401;
                }

                .tombstone-lower-separator-right {
                  position: absolute;
                  bottom: 0px;
                  left: 435px;
                  width: 4px;
                  height: 12px;
                  background-color: #808080;
                  z-index: 11401;
                }

                .tombstone-lower {
                  position: absolute;
                  bottom: 0px;
                  left: 35px;
                  width: 400px;
                  height: 12px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 5px #0009;
                  z-index: 11400;
                }

                .tombstone-home-section {
                  position: absolute;
                  top: 5px;
                  left: 60px;
                  width: 300px;
                  height: 54px;
                  display: flex;
                  flex-direction: column;
                  justify-content: center;
                  z-index: 11405;
                  pointer-events: none;
                  text-align: left;
                }

                .tombstone-team-name {
                  font-size: 15px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 1.5px;
                  margin-bottom: -2px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                .tombstone-team-mascot {
                  margin-top: -2px;
                  font-size: 26px;
                  font-weight: 200;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 2px;
                  margin-bottom: -5px;
                  font-family: Impact, Charcoal, sans-serif;
                }

                /* ------------------------
                   Mini Bug
                   ------------------------ */
                .mini-bug {
                  position: absolute;
                  right: 40px;
                  bottom: 69px; /* Same y-position as scorebar */
                  display: flex;
                  align-items: center;
                  gap: 0;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 20px #0009;
                  height: 60px;
                  z-index: 9998;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                }

                .mini-bug::before {
                  content: "";
                  position: absolute;
                  top: -4px;
                  left: -20px;
                  right: -20px;
                  height: calc(100% + 8px);
                  border: 4px solid #808080;
                  border-radius: 8px;
                  z-index: -1;
                  pointer-events: none;
                  box-sizing: border-box;
                }

                .mini-bug.hidden {
                  transform: translateX(400px);
                  pointer-events: none;
                }

                /* Mini bug lower section */
                .mini-bug-lower-separator-left {
                  position: absolute;
                  right: 335px;
                  bottom: 50px;
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower.first {
                  position: absolute;
                  right: 265px;
                  bottom: 50px;
                  width: 70px;
                  height: 15px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 10px #0009;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower-separator-right {
                  position: absolute;
                  right: 262px;
                  bottom: 50px;
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower-white-block {
                  position: absolute;
                  right: 192px;
                  bottom: 50px;
                  width: 70px;
                  height: 15px;
                  background: white;
                  z-index: 9998;
                  overflow: hidden;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }
                .mini-bug-lower-white-block::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .mini-bug-lower-separator-after-white {
                  position: absolute;
                  right: 188px;
                  bottom: 50px;
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower.second {
                  position: absolute;
                  right: 118px;
                  bottom: 50px;
                  width: 70px;
                  height: 15px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-shadow: inset 0 0 10px #0009;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower-separator-after-second {
                  position: absolute;
                  right: 114px;
                  bottom: 50px;
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower-white-block.second {
                  position: absolute;
                  right: 44px;
                  bottom: 50px;
                  width: 70px;
                  height: 15px;
                  background: white;
                  z-index: 9998;
                  overflow: hidden;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }
                .mini-bug-lower-white-block.second::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .mini-bug-lower-separator-final {
                  position: absolute;
                  right: 40px;
                  bottom: 50px;
                  height: 15px;
                  width: 4px;
                  background-color: #808080;
                  z-index: 9997;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                }

                .mini-bug-lower-separator-left.hidden,
                .mini-bug-lower.first.hidden,
                .mini-bug-lower-separator-right.hidden,
                .mini-bug-lower-white-block.hidden,
                .mini-bug-lower-separator-after-white.hidden,
                .mini-bug-lower.second.hidden,
                .mini-bug-lower-separator-after-second.hidden,
                .mini-bug-lower-white-block.second.hidden,
                .mini-bug-lower-separator-final.hidden {
                  transform: translateX(400px);
                  pointer-events: none;
                }

                .mini-color-square {
                  width: 70px;
                  height: 60px;
                  position: relative;
                  overflow: hidden;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                }

                .mini-color-square::after {
                  content: "";
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  pointer-events: none;
                  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.6) 100%);
                  mix-blend-mode: multiply;
                }

                .mini-color-square img {
                  position: relative;
                  max-height: 50px;
                  max-width: 60px;
                  object-fit: contain;
                  pointer-events: none;
                  user-select: none;
                  z-index: 1;
                }

                .mini-score {
                  font-family: 'Oswald', sans-serif;
                  font-weight: 700;
                  font-size: 34px;
                  color: #000;
                  width: 70px;
                  height: 60px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background:
                    radial-gradient(circle at center, #fff 60%, #bbb 100%);
                  box-shadow:
                    inset 0 0 8px rgba(0, 0, 0, 0.5);
                  border: 1px solid #888;
                  user-select: none;
                  box-sizing: border-box;
                  padding: 0;
                  margin: 0;
                  vertical-align: middle;
                  position: relative;
                }

                .mini-score-overlay {
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  opacity: 0;
                  transform: scale(0.8);
                  pointer-events: none;
                  z-index: 1000;
                  border: 1px solid #888;
                  box-sizing: border-box;
                }

                .mini-score-overlay.animate {
                  animation: scoreSlate 1s ease-out forwards;
                }

                .mini-score-overlay img {
                  max-height: 40px;
                  max-width: 50px;
                  object-fit: contain;
                  filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
                }

                /* ------------------------
                   Ticker
                   ------------------------ */
                .ticker-container {
                  position: absolute;
                  bottom: 0;
                  left: 0;
                  right: 0;
                  height: 50px;
                  display: flex;
                  background: #222;
                  color: #eee;
                  font-size: 18px;
                  overflow: hidden;
                  white-space: nowrap;
                  box-shadow: inset 0 0 5px #000;
                  z-index: 11000;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                }

                .ticker-container.hidden {
                  transform: translateY(100px);
                  opacity: 0;
                  pointer-events: none;
                }

                .ticker-left-block {
                  flex: 0 0 200px;
                  height: 50px;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #1a1a1a 0px,
                      #1a1a1a 4px,
                      #2a2a2a 4px,
                      #2a2a2a 8px
                    );
                  border: 1px solid #444;
                  box-shadow:
                    inset 0 1px 0 rgba(255,255,255,0.1),
                    inset 0 -1px 0 rgba(0,0,0,0.3),
                    8px 0 15px rgba(0,0,0,0.7);
                  pointer-events: none;
                  z-index: 11002;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  position: relative;
                  overflow: hidden;
                }

                .ticker-logo {
                  max-height: 50px;
                  max-width: 100px;
                  object-fit: contain;
                  z-index: 11003;
                  position: relative;
                }

                .ticker-content {
                  flex: 1;
                  overflow: hidden;
                  position: relative;
                  height: 100%;
                  background: #222;
                }

                .ticker-scrolling-text {
                  display: inline-block;
                  padding-left: 20px;
                  line-height: 55px;
                  font-size: 20px;
                  white-space: nowrap;
                  font-family: Arial, sans-serif;
                  font-weight: 500;
                  color: #eee;
                  animation: tickerSlideUpAndScroll 25s linear infinite;
                }

                @keyframes tickerSlideUpAndScroll {
                  0% {
                    transform: translateY(100%) translateX(0);
                  }
                  4% {
                    transform: translateY(0) translateX(0);
                  }
                  20% {
                    transform: translateY(0) translateX(0);
                  }
                  100% {
                    transform: translateY(0) translateX(-100%);
                  }
                }

                .lower-scorebar.first .rect,
                .lower-scorebar.second .rect {
                  height: 8px;
                  flex-shrink: 0;
                  margin-right: 15px;
                  border-radius: 3px;
                  width: calc((100% - 4 * 15px) / 5);
                  background-color: #ffea3a;
                  box-shadow: 0 0 4px 1px rgba(255, 234, 58, 0.5);
                  transition: background-color 0.3s ease, box-shadow 0.3s ease, width 0.3s ease, margin-right 0.3s ease;
                }

                /* Football-specific wider timeout rectangles */
                .lower-scorebar.first .rect.football-mode,
                .lower-scorebar.second .rect.football-mode {
                  width: calc(100% - 280px);
                  margin-left: 10px;
                  margin-right: 10px;
                }

                /* Volleyball-specific wider timeout rectangles */
                .lower-scorebar.first .rect.volleyball-mode,
                .lower-scorebar.second .rect.volleyball-mode {
                  width: calc(100% - 250px);
                  margin-left: 10px;
                  margin-right: 10px;
                }

                .lower-scorebar.first .rect:last-child,
                .lower-scorebar.second .rect:last-child {
                  margin-right: 0;
                }
                .lower-scorebar.first .rect.used,
                .lower-scorebar.second .rect.used {
                  background-color: #555555;
                  box-shadow: none;
                }

                /* Timeout flash animation */
                @keyframes timeoutFlash {
                  0%, 16.66% { background-color: #ffea3a; box-shadow: 0 0 4px 1px rgba(255, 234, 58, 0.5); }
                  16.67%, 33.33% { background-color: #555555; box-shadow: none; }
                  33.34%, 49.99% { background-color: #ffea3a; box-shadow: 0 0 4px 1px rgba(255, 234, 58, 0.5); }
                  50%, 66.66% { background-color: #555555; box-shadow: none; }
                  66.67%, 83.33% { background-color: #ffea3a; box-shadow: 0 0 4px 1px rgba(255, 234, 58, 0.5); }
                  83.34%, 100% { background-color: #555555; box-shadow: none; }
                }

                .lower-scorebar.first .rect.flashing,
                .lower-scorebar.second .rect.flashing {
                  animation: timeoutFlash 1.2s ease-in-out 1;
                  animation-fill-mode: forwards;
                }

                .football-timeout-square.flashing {
                  animation: timeoutFlash 1.2s ease-in-out 1;
                  animation-fill-mode: forwards;
                }

                /* Football-specific timeout squares positioned left of score separator */
                .scorebar.football-mode .home-wrapper::before,
                .scorebar.football-mode .away-wrapper::before {
                  content: '';
                  position: absolute;
                  left: -40px;
                  top: 10px;
                  width: 30px;
                  height: 40px;
                  display: flex;
                  flex-direction: column;
                  gap: 2px;
                  z-index: 20;
                }

                .scorebar.football-mode .home-wrapper {
                  position: relative;
                }

                .scorebar.football-mode .away-wrapper {
                  position: relative;
                }

                /* Create timeout squares using CSS */
                .football-timeout-squares {
                  position: absolute;
                  right: 60px;
                  top: 6px;
                  width: 30px;
                  height: 50px;
                  display: flex;
                  flex-direction: column;
                  gap: 6px;
                  z-index: 20;
                }

                .football-timeout-square {
                  width: 12px;
                  height: 12px;
                  background: #ffea3a;
                  box-shadow: 0 0 4px 1px rgba(255, 234, 58, 0.5);
                  border-radius: 2px;
                }

                .football-timeout-square.used {
                  background: #555555;
                  box-shadow: none;
                }


              /* ------------------------
                   Left Slab
                   ------------------------ */
                .left-slab {
                  position: fixed;
                  top: 0;
                  left: 0;
                  width: 400px;
                  height: 100vh;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #333333 0px,
                      #333333 8px,
                      #373737 8px,
                      #373737 16px,
                      #2f2f2f 16px,
                      #2f2f2f 24px,
                      #3a3a3a 24px,
                      #3a3a3a 32px
                    );
                  z-index: 10000;
                  pointer-events: none;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                }

                .left-slab.hidden {
                  transform: translateX(-400px);
                  opacity: 0;
                  pointer-events: none;
                }

                .left-slab-separator {
                  position: fixed;
                  top: 0;
                  left: 400px;
                  width: 4px;
                  height: 100vh;
                  background-color: #808080;
                  z-index: 10001;
                  pointer-events: none;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                }

                .left-slab-separator.hidden {
                  transform: translateX(-400px);
                  opacity: 0;
                  pointer-events: none;
                }

                .left-slab-section {
                  position: absolute;
                  background: white;
                  border: 2px solid #808080;
                  border-radius: 4px;
                  z-index: 10002;
                  pointer-events: none;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  display: flex;
                  flex-direction: column;
                  align-items: flex-start;
                  justify-content: flex-start;
                  color: #333;
                  font-family: Arial, sans-serif;
                  font-weight: bold;
                  font-size: 14px;
                  text-align: left;
                  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                  box-sizing: border-box;
                }

                .left-slab-section::before {
                  content: "";
                  position: absolute;
                  top: 8px;
                  left: -15px;
                  width: 30px;
                  height: 4px;
                  background:
                    repeating-linear-gradient(
                      90deg,
                      #c41e3a 0px,
                      #c41e3a 2px,
                      #d32f2f 2px,
                      #d32f2f 4px,
                      #b71c1c 4px,
                      #b71c1c 6px
                    );
                  border-radius: 2px;
                  box-shadow:
                    0 1px 2px rgba(0,0,0,0.3),
                    inset 0 1px 0 rgba(255,255,255,0.2);
                  z-index: 1;
                }

                .left-slab-section.hidden {
                  transform: translateX(-400px);
                  opacity: 0;
                  pointer-events: none;
                }

                .left-slab-title {
                  position: absolute;
                  color: #fff;
                  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                  font-size: 28px;
                  font-weight: 600;
                  text-transform: uppercase;
                  letter-spacing: 2px;
                  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
                  z-index: 10003;
                  pointer-events: none;
                  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                  line-height: 1.2;
                }

                .left-slab-title.hidden {
                  transform: translateX(-400px);
                  opacity: 0;
                  pointer-events: none;
                }

                /* Stats Rectangle */
                .stats-rectangle {
                  position: absolute;
                  bottom: 129px;
                  left: calc(50% - 189px);
                  transform: translateX(-50%) translateY(150px);
                  width: 976px;
                  max-width: 1600px;
                  height: 35px;
                  background: linear-gradient(
                    to left,
                    var(--away-color) 0%,
                    black 40%,
                    black 60%,
                    var(--home-color) 100%
                  );
                  letter-spacing: 1.2px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 0;
                  box-sizing: border-box;
                  z-index: 1;
                  box-shadow: inset 0 0 20px #0009;
                  white-space: nowrap;
                  opacity: 0;
                  pointer-events: none;
                  /* Hiding (150px  0, fade-out: slow  fast) */
                  transition: opacity 0.5s cubic-bezier(0.42, 0, 1, 1),
                              transform 0.5s cubic-bezier(0.42, 0, 1, 1);
                  border: 4px solid #808080;
                }

                .stats-rectangle.visible {
                  opacity: 1;
                  transform: translateX(-50%) translateY(0);
                  pointer-events: auto;
                  /* Showing (0  150px, fade-in: fast  slow) */
                  transition: opacity 0.5s cubic-bezier(0, 0, 0.58, 1),
                              transform 0.5s cubic-bezier(0, 0, 0.58, 1);
                }

                .stats-rectangle.volleyball-mode {
                  width: 902px;
                  left: calc(50% - 147px);
                }

                .stats-display {
                  display: flex;
                  align-items: center;
                  justify-content: space-between;
                  width: 100%;
                  height: 100%;
                  gap: 40px;
                }

                .stats-label {
                  font-family: 'Oswald', sans-serif;
                  font-weight: 800;
                  font-size: 20px;
                  color: #fff;
                  text-transform: uppercase;
                  letter-spacing: 3px;
                  text-align: center;
                  flex: 1;
                }

                .stats-data {
                  font-family: 'Oswald', sans-serif;
                  font-size: 22px;
                  font-weight: 800;
                  color: #fff;
                  text-align: center;
                  min-width: 80px;
                }

                /* Fullscreen Square */
                .fullscreen-square {
                  position: fixed;
                  top: 48%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  width: 0%;
                  height: 80%;
                  background:
                    repeating-linear-gradient(
                      45deg,
                      #2b2f33,
                      #2b2f33 2px,
                      #383c40 4px,
                      #383c40 6px
                    ),
                    linear-gradient(135deg, #3d4248, #1a1f22);
                  box-sizing: border-box;
                  z-index: 20000;
                  opacity: 0;
                  transition: width 0.5s ease-in-out, opacity 0.5s ease-in-out;
                  overflow: visible;
                }

                .fullscreen-square::before {
                    content: "";
                    position: absolute;
                    top: -4px;
                    left: -18px;
                    right: -18px;
                    bottom: -4px;
                    border: 4px solid #808080;
                    border-radius: 12px;
                    pointer-events: none;
                    box-sizing: border-box;
                }

                .fullscreen-left-separator {
                  position: fixed;
                  top: 48%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  margin-left: 0px;
                  width: 4px;
                  height: 80%;
                  background-color: #808080;
                  z-index: 20001;
                  opacity: 0;
                  transition: margin-left 0.5s ease-in-out, opacity 0.5s ease-in-out;
                  pointer-events: none;
                }

                .fullscreen-right-separator {
                  position: fixed;
                  top: 48%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  margin-left: 0px;
                  width: 4px;
                  height: 80%;
                  background-color: #808080;
                  z-index: 20001;
                  opacity: 0;
                  transition: margin-left 0.5s ease-in-out, opacity 0.5s ease-in-out;
                  pointer-events: none;
                }

                .fullscreen-left-separator.visible {
                  margin-left: -652px;
                  opacity: 1;
                }

                .fullscreen-right-separator.visible {
                  margin-left: 652px;
                  opacity: 1;
                }

                .fullscreen-square.visible {
                  width: 85%;
                  opacity: 1;
                }

                /* Bracket Styles */
                .bracket-container {
                  display: flex;
                  justify-content: space-evenly;
                  align-items: center;
                  height: 100%;
                  width: 100%;
                  padding: 20px;
                  box-sizing: border-box;
                }

                .bracket-round {
                  display: flex;
                  flex-direction: column;
                  justify-content: space-evenly;
                  flex: 0 0 auto;
                  height: 100%;
                  position: relative;
                  padding: 0 30px;
                }

                .bracket-game {
                  background: transparent;
                  border: none;
                  border-radius: 0;
                  padding: 0;
                  margin: 8px 5px;
                  position: relative;
                  display: flex;
                  flex-direction: column;
                  align-items: flex-start;
                }

                .bracket-round:nth-child(1) .bracket-game {
                  height: 80px;
                }

                .bracket-round:nth-child(2) .bracket-game {
                  height: 80px;
                }

                .bracket-round:nth-child(3) .bracket-game {
                  height: 180px;
                  margin-top: 102px;
                }

                .bracket-round:nth-child(4) .bracket-game {
                  height: 380px;
                  margin-top: 250px;
                }

                .bracket-team {
                  background: linear-gradient(135deg, #3d4248, #1a1f22);
                  border: none;
                  border-radius: 4px;
                  padding: 8px 12px;
                  margin: 6px 0;
                  color: #fff;
                  font-family:Georgia, 'Times New Roman', Times, serif;
                  font-size: 22px;
                  font-weight: 500;
                  text-transform: uppercase;
                  letter-spacing: 1px;
                  box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
                  white-space: nowrap;
                  overflow: visible;
                  text-align: left;
                  width: 100%;
                  display: block;
                  transition: color 0.3s ease;
                  box-sizing: border-box;
                }

                .bracket-team.won {
                  color: #4CAF50;
                }

                .bracket-team.lost {
                  color: #f44336;
                }
                
              </style>
              </head>
              <body>

              <!-- Fullscreen Square -->
              <div class="fullscreen-square" id="fullscreenSquare">
                <!-- Tournament Title -->
                  <h1 style="position: absolute; right: 150px; top: -25px; font-size: 45px; font-weight: bold; color: #fff; font-family:Verdana, Geneva, Tahoma, sans-serif; letter-spacing: 2px; text-transform: uppercase;">4A State Volleyball Tournament</h1>
                
                <!-- Bracket Container -->
                <div class="bracket-container">
                  <!-- Round 1: 4 games (8 teams) -->
                  <div class="bracket-round">
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam1">Team 1</div>
                      <div class="bracket-team" id="bracketTeam2">Team 2</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam3">Team 3</div>
                      <div class="bracket-team" id="bracketTeam4">Team 4</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam5">Team 5</div>
                      <div class="bracket-team" id="bracketTeam6">Team 6</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam7">Team 7</div>
                      <div class="bracket-team" id="bracketTeam8">Team 8</div>
                    </div>
                  </div>

                  <!-- Round 2: 4 games (8 teams) -->
                  <div class="bracket-round">
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam9">Team 9</div>
                      <div class="bracket-team" id="bracketTeam10">Team 10</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam11">Team 11</div>
                      <div class="bracket-team" id="bracketTeam12">Team 12</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam13">Team 13</div>
                      <div class="bracket-team" id="bracketTeam14">Team 14</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam15">Team 15</div>
                      <div class="bracket-team" id="bracketTeam16">Team 16</div>
                    </div>
                  </div>

                  <!-- Round 3: 2 games (4 teams) -->
                  <div class="bracket-round">
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam17">Team 17</div>
                      <div class="bracket-team" id="bracketTeam18">Team 18</div>
                    </div>
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam19">Team 19</div>
                      <div class="bracket-team" id="bracketTeam20">Team 20</div>
                    </div>
                  </div>

                  <!-- Round 4: 1 game (2 teams) -->
                  <div class="bracket-round">
                    <div class="bracket-game">
                      <div class="bracket-team" id="bracketTeam21">Team 21</div>
                      <div class="bracket-team" id="bracketTeam22">Team 22</div>
                    </div>
                  </div>
                </div>
                
                <!-- Championship Logo -->
                <div style="position: absolute; bottom: 50px; right: -25px; transform: translateX(-50%); text-align: center;">
                  <img id="championshipLogo" src="../../IMAGES/State_logo.png" alt="Championship Logo" style="max-height: 200px; max-width: 300px; object-fit: contain; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));">
                </div>
              </div>
              <div class="fullscreen-left-separator" id="fullscreenLeftSeparator"></div>
              <div class="fullscreen-right-separator" id="fullscreenRightSeparator"></div>

              <!-- Left Slab -->
              <div class="left-slab">
                <div id="leftSlabSectionsContainer"></div>
              </div>
              <div class="left-slab-separator"></div>

              <!-- Stats Rectangle -->
              <div class="stats-rectangle football-only" id="statsRectangle">
                <div class="stats-display">
                  <div class="stats-data" id="statsDataHome">0</div>
                  <div class="stats-label" id="statsLabel">Stat Name</div>
                  <div class="stats-data" id="statsDataAway">0</div>
                </div>
              </div>



              <!-- Flag Overlay - spans clock and down & distance sections -->
              <div class="flag-overlay" id="flagOverlay">
                <div class="flag-pulse" id="flagPulse"><span>FLAG</span></div>
              </div>

              <!-- TOUCHDOWN Animation -->
              <img id="touchdownLogoLeft" class="touchdown-logo" style="display: none;" alt="Scoring Team Logo" />
              <div id="touchdownOutput"></div>

              <div class="scorebar" role="region" aria-label="Basketball Scoreboard">
                <div class="vertical-bar-left"></div>

                <div class="home-wrapper">
                  <div class="football-timeout-squares" id="homeFootballTimeouts" style="display: none;">
                    <div class="football-timeout-square" id="homeTimeout1"></div>
                    <div class="football-timeout-square" id="homeTimeout2"></div>
                    <div class="football-timeout-square" id="homeTimeout3"></div>
                  </div>
                  <div class="team-color-strip" id="homeColorStripFarLeft" style="background-color:#c41e3a;"></div>
                  <div class="team-color-strip" id="homeColorStripLeft" style="background-color:#c41e3a;"></div>
                  <div class="color-square" id="homeColorSquare" style="background-color:#c41e3a;">
                    <img id="homeLogoImg" alt="Home Team Logo" />
                  </div>
                  <div class="team-color-strip" id="homeColorStripRight" style="background-color:#c41e3a;"></div>

                  <div class="home-name school-name" id="homeNameDisplay">
                    <div class="team-name-text">HOME TEAM</div>
                    <div class="school-mascot" id="homeMascotDisplay">MASCOT</div>
                  </div>
                  <div class="separator"></div>
                  <div class="home-score score" id="homeScore">
                    <span>0</span>
                    <div class="score-overlay" id="homeScoreOverlay">
                      <img id="homeScoreOverlayImg" alt="Home Team Logo" />
                    </div>
                  </div>
                </div>

                <div class="separator"></div>

                <div class="away-wrapper">
                  <div class="football-timeout-squares" id="awayFootballTimeouts" style="display: none;">
                    <div class="football-timeout-square" id="awayTimeout1"></div>
                    <div class="football-timeout-square" id="awayTimeout2"></div>
                    <div class="football-timeout-square" id="awayTimeout3"></div>
                  </div>
                  <div class="team-color-strip" id="awayColorStripLeft" style="background-color:#006633;"></div>
                  <div class="color-square" id="awayColorSquare" style="background-color:#006633;">
                    <img id="awayLogoImg" alt="Away Team Logo" />
                  </div>
                  <div class="team-color-strip" id="awayColorStripRight" style="background-color:#006633;"></div>

                  <div class="away-name school-name" id="awayNameDisplay">
                    <div class="team-name-text">AWAY TEAM</div>
                    <div class="school-mascot" id="awayMascotDisplay">MASCOT</div>
                  </div>
                  <div class="separator"></div>
                  <div class="away-score score" id="awayScore">
                    <span>0</span>
                    <div class="score-overlay" id="awayScoreOverlay">
                      <img id="awayScoreOverlayImg" alt="Away Team Logo" />
                    </div>
                  </div>
                </div>

                <div class="separator"></div>

                <div class="period period-display" id="periodDisplay" role="timer" aria-live="polite" aria-atomic="true">1st</div>

                <div class="separator"></div>

                <div class="clock clock-display" id="clockDisplay" role="timer" aria-live="polite" aria-atomic="true">12:00</div>

                <div class="separator football-section-separator" id="footballSectionSeparator" style="display: none;"></div>

                <div class="football-section" id="footballSection" style="display: none;">
                  <div class="football-combined" id="footballCombined">
                    <span id="footballDown">1st</span>
                    <span class="football-ampersand">&</span>
                    <span id="footballToGo">10</span>
                  </div>
                </div>

                <!-- Volleyball set section -->
                <div class="volleyball-set-section" id="volleyballSetSection">
                  <span id="volleyballSetDisplay">Set 0/5</span>
                </div>

                <div class="vertical-bar-right"></div>
              </div>

              <!-- Lower scorebars (timeouts visual) -->
              <div class="lower-scorebar first">
                <div class="rect"></div><div class="rect"></div><div class="rect"></div><div class="rect"></div><div class="rect"></div>
              </div>
              <div class="lower-separator-left"></div>
              <div class="lower-white-block"></div>
              <div class="lower-separator-right"></div>

              <div class="lower-scorebar second">
                <div class="rect"></div><div class="rect"></div><div class="rect"></div><div class="rect"></div><div class="rect"></div>
              </div>
              <div class="lower-separator-right-2"></div>
              <div class="lower-separator-after-second"></div>
              <div class="lower-white-block after-second"></div>
              <div class="lower-separator-after-white"></div>

              <div class="lower-scorebar third"></div>
              <div class="lower-separator-after-third"></div>

              <!-- Lower Third -->
              <div class="mini-locator-wrapper" id="miniLocatorWrapper">
                <div class="mini-locator-team-color-strip-left" id="miniLocatorTeamColorStripLeft"></div>
                <div class="mini-locator-team-color-left" id="miniLocatorTeamColorLeft"></div>
                <div class="mini-locator-team-logo mini-locator-team-logo-left" id="miniLocatorTeamLogoLeft">
                  <img id="miniLocatorHomeLogoImg" alt="Home Team Logo" />
                </div>
                <div class="mini-locator-team-color-inner-strip-left" id="miniLocatorTeamColorInnerStripLeft"></div>
                <div class="mini-locator-separator-left"></div>
                <div class="mini-locator">
                  <div class="mini-locator-home-section">
                    <div class="mini-locator-team-mascot" id="miniLocatorHomeMascot">FULL NAME</div>
                    <div class="mini-locator-team-name" id="miniLocatorHomeName">TITLE</div>
                  </div>
                </div>
                <div class="mini-locator-separator-right"></div>

                <!-- Lower Third Lower Section -->
                <div class="mini-locator-lower-separator-left"></div>
                <div class="mini-locator-lower"></div>
                <div class="mini-locator-lower-separator-right"></div>
              </div>

              <!-- Tombstone -->
              <div class="tombstone-wrapper" id="tombstoneWrapper">
                <div id="tombstoneSectionsContainer"></div>
                <div class="tombstone-team-color-strip-left" id="tombstoneTeamColorStripLeft"></div>
                <div class="tombstone-team-color-left" id="tombstoneTeamColorLeft"></div>
                <div class="tombstone-team-logo tombstone-team-logo-left" id="tombstoneTeamLogoLeft">
                  <img id="tombstoneHomeLogoImg" alt="Home Team Logo" />
                  <div class="tombstone-home-section">
                    <div class="tombstone-team-name" id="tombstoneHomeName">TEAM NAME</div>
                    <div class="tombstone-team-mascot" id="tombstoneHomeMascot">MASCOT</div>
                  </div>
                </div>
                <div class="tombstone-team-color-inner-strip-left" id="tombstoneTeamColorInnerStripLeft"></div>
                <div class="tombstone-separator-left"></div>
                <div class="tombstone">
                </div>
                <div class="tombstone-separator-right"></div>

                <!-- Tombstone Lower Section -->
                <div class="tombstone-lower-separator-left"></div>
                <div class="tombstone-lower"></div>
                <div class="tombstone-lower-separator-right"></div>
              </div>

              <!-- Talent Locator Left -->
              <div class="talent-locator-wrapper" id="talentLocatorWrapper">
                <div class="talent-locator-team-color-strip-left" id="talentLocatorTeamColorStripLeft"></div>
                <div class="talent-locator-team-color-left" id="talentLocatorTeamColorLeft"></div>
                <div class="talent-locator-team-logo talent-locator-team-logo-left" id="talentLocatorTeamLogoLeft">
                  <img id="talentLocatorHomeLogoImg" alt="Talent Team Logo" />
                </div>
                <div class="talent-locator-team-color-inner-strip-left" id="talentLocatorTeamColorInnerStripLeft"></div>
                <div class="talent-locator-separator-left"></div>
                <div class="talent-locator">
                  <div class="talent-locator-home-section">
                    <div class="talent-locator-team-mascot" id="talentLocatorHomeMascot">FULL NAME</div>
                    <div class="talent-locator-team-name" id="talentLocatorHomeName">TITLE</div>
                  </div>
                </div>
                <div class="talent-locator-separator-right"></div>

                <!-- Talent Locator Lower Section -->
                <div class="talent-locator-lower-separator-left"></div>
                <div class="talent-locator-lower"></div>
                <div class="talent-locator-lower-separator-right"></div>
              </div>

              <!-- Talent Locator Right -->
              <div class="talent-locator-right-wrapper" id="talentLocatorRightWrapper">
                <div class="talent-locator-right-team-color-strip-right" id="talentLocatorRightTeamColorStripRight"></div>
                <div class="talent-locator-right-team-color-right" id="talentLocatorRightTeamColorRight"></div>
                <div class="talent-locator-right-team-logo talent-locator-right-team-logo-right" id="talentLocatorRightTeamLogoRight">
                  <img id="talentLocatorRightHomeLogoImg" alt="Talent Right Team Logo" />
                </div>
                <div class="talent-locator-right-team-color-inner-strip-right" id="talentLocatorRightTeamColorInnerStripRight"></div>
                <div class="talent-locator-right-separator-right"></div>
                <div class="talent-locator-right">
                  <div class="talent-locator-right-home-section">
                    <div class="talent-locator-right-team-mascot" id="talentLocatorRightHomeMascot">FULL NAME</div>
                    <div class="talent-locator-right-team-name" id="talentLocatorRightHomeName">TITLE</div>
                  </div>
                </div>
                <div class="talent-locator-right-separator-left"></div>

                <!-- Talent Locator Right Lower Section -->
                <div class="talent-locator-right-lower-separator-right"></div>
                <div class="talent-locator-right-lower"></div>
                <div class="talent-locator-right-lower-separator-left"></div>
              </div>

              <!-- Locator -->
              <div class="locator-wrapper" id="locatorWrapper">
                <div class="locator-team-color-strip-left" id="locatorTeamColorStripLeft"></div>
                <div class="locator-team-color-left" id="locatorTeamColorLeft"></div>
                <div class="locator-team-logo locator-team-logo-left" id="locatorTeamLogoLeft">
                  <img id="locatorHomeLogoImg" alt="Home Team Logo" />
                </div>
                <div class="locator-team-color-inner-strip-left" id="locatorTeamColorInnerStripLeft"></div>
                <div class="locator-separator-left"></div>
                <div class="locator">
                  <div class="locator-home-section">
                    <div class="locator-team-name" id="locatorHomeName">HOME FULL SCHOOL NAME</div>
                    <div class="locator-team-mascot" id="locatorHomeMascot">HOME SCHOOL MASCOT</div>
                  </div>
                  <div class="locator-away-section">
                    <div class="locator-team-name" id="locatorAwayName">AWAY FULL SCHOOL NAME</div>
                    <div class="locator-team-mascot" id="locatorAwayMascot">AWAY SCHOOL MASCOT</div>
                  </div>
                </div>
                <div class="locator-separator-right"></div>
                <div class="locator-team-color-inner-strip-right" id="locatorTeamColorInnerStripRight"></div>
                <div class="locator-team-logo locator-team-logo-right" id="locatorTeamLogoRight">
                  <img id="locatorAwayLogoImg" alt="Away Team Logo" />
                </div>
                <div class="locator-team-color-right" id="locatorTeamColorRight"></div>
                <div class="locator-team-color-strip-right" id="locatorTeamColorStripRight"></div>
                <div class="locator-separator-middle"></div>

                <!-- Locator Lower Section -->
                <div class="locator-lower-separator-left"></div>
                <div class="locator-lower"></div>
                <div class="locator-lower-separator-right"></div>
                <div class="locator-lower-separator-center"></div>
              </div>

              <!-- Mini Bug -->
              <div class="mini-bug">
                <div class="separator"></div>
                <div class="mini-color-square" id="miniBugHomeColorSquare" style="background-color:#c41e3a;">
                  <img id="miniBugHomeLogoImg" alt="Home Team Logo" />
                </div>
                <div class="separator"></div>
                <div class="mini-score" id="miniBugHomeScore">
                  <span>0</span>
                  <div class="mini-score-overlay" id="miniBugHomeScoreOverlay">
                    <img id="miniBugHomeScoreOverlayImg" alt="Home Team Logo" />
                  </div>
                </div>
                <div class="separator"></div>
                <div class="mini-color-square" id="miniBugAwayColorSquare" style="background-color:#006633;">
                  <img id="miniBugAwayLogoImg" alt="Away Team Logo" />
                </div>
                <div class="separator"></div>
                <div class="mini-score" id="miniBugAwayScore">
                  <span>0</span>
                  <div class="mini-score-overlay" id="miniBugAwayScoreOverlay">
                    <img id="miniBugAwayScoreOverlayImg" alt="Away Team Logo" />
                  </div>
                </div>
                <div class="separator"></div>
              </div>

              <!-- Mini Bug Lower Section -->
              <div class="mini-bug-lower-separator-left"></div>
              <div class="mini-bug-lower first"></div>
              <div class="mini-bug-lower-separator-right"></div>
              <div class="mini-bug-lower-white-block"></div>
              <div class="mini-bug-lower-separator-after-white"></div>
              <div class="mini-bug-lower second"></div>
              <div class="mini-bug-lower-separator-after-second"></div>
              <div class="mini-bug-lower-white-block second"></div>
              <div class="mini-bug-lower-separator-final"></div>

              <div class="ticker-container">
                <div class="ticker-left-block">
                  <img src="../../IMAGES/CSN_logo.png" alt="Logo" class="ticker-logo" id="tickerLogo">
                </div>
                <div class="ticker-content">
                  <div class="ticker-scrolling-text" id="tickerScrollingText">
                  </div>
                </div>
              </div>

              <script>
                /* ------------------------
                   Scoreboard behaviour (preserved logic)
                   ------------------------ */
                // Timeout buttons and counts
                const MAX_TIMEOUTS = 5;
                const MAX_TIMEOUTS_FOOTBALL = 3;
                const MAX_TIMEOUTS_VOLLEYBALL = 2;
                let homeTimeoutsLeft = MAX_TIMEOUTS;
                let awayTimeoutsLeft = MAX_TIMEOUTS;

                const periodMap = {
                  'Q1': '1st',
                  'Q2': '2nd',
                  'Q3': '3rd',
                  'Q4': '4th',
                  'OT1': 'OT1',
                  'OT2': 'OT2',
                  'OT3': 'OT3',
                  'OT4': 'OT4',
                  '1ST': '1st',
                  '2ND': '2nd',
                  'HALF': 'HALF',
                  '3RD': '3rd',
                  '4TH': '4th',
                  'FINAL': 'FINAL'
                };

                function normalizePeriod(period) {
                  if (!period) return '1st';
                  return periodMap[period.toUpperCase()] || period;
                }

                function clampInt(n, min, max) {
                  n = Number(n);
                  if (isNaN(n)) return min;
                  return Math.max(min, Math.min(max, Math.floor(n)));
                }

                // Format clock time to remove leading zeros from minutes
                function formatClockTime(timeStr) {
                  if (!timeStr || typeof timeStr !== 'string') return timeStr;
                  const parts = timeStr.split(':');
                  if (parts.length === 2) {
                    const minutes = parseInt(parts[0], 10);
                    const seconds = parts[1];
                    // Show :XX when minutes = 0, otherwise remove leading zero for single digits
                    if (minutes === 0) {
                      return `:${seconds}`;
                    } else if (minutes < 10) {
                      return `${minutes}:${seconds}`;
                    }
                  }
                  return timeStr;
                }

                // Track last clock update to ensure consistency
                let lastClockUpdate = '';

                // Touchdown animation state
                let touchdownAnimationPlaying = false;

                function showTouchdownAnimation() {
                  if (touchdownAnimationPlaying) return;

                  touchdownAnimationPlaying = true;
                  const output = document.getElementById("touchdownOutput");
                  const touchdownLogoLeft = document.getElementById("touchdownLogoLeft");
                  const word = "TOUCHDOWN";

                  output.innerHTML = "";

                  // Slide in the logo at the start
                  if (touchdownLogoLeft) {
                    touchdownLogoLeft.classList.add("show");
                    touchdownLogoLeft.classList.remove("hide");
                  }

                  [...word].forEach((letter, index) => {
                    const wrapper = document.createElement("span");
                    wrapper.classList.add("letter-wrapper");

                    const outline = document.createElement("span");
                    outline.textContent = letter;
                    outline.classList.add("letter-outline");

                    const span = document.createElement("span");
                    span.textContent = letter;
                    span.classList.add("letter");

                    wrapper.appendChild(outline);
                    wrapper.appendChild(span);
                    output.appendChild(wrapper);

                    setTimeout(() => {
                      span.classList.add("show");
                      outline.classList.add("show");
                    }, index * 100);
                  });

                  // After slide-up animation completes (0.4s), add bounce effect
                  setTimeout(() => {
                    const letters = output.querySelectorAll('.letter');
                    const outlines = output.querySelectorAll('.letter-outline');

                    letters.forEach((letter, index) => {
                      setTimeout(() => {
                        letter.classList.add('bounce-up');
                      }, index * 50);
                    });

                    outlines.forEach((outline, index) => {
                      setTimeout(() => {
                        outline.classList.add('bounce-up');
                      }, index * 50);
                    });

                    // Clean up bounce class after animation
                    setTimeout(() => {
                      letters.forEach(letter => letter.classList.remove('bounce-up'));
                      outlines.forEach(outline => outline.classList.remove('bounce-up'));
                    }, 900);
                  }, 1000); // Wait for slide-up to complete (9 letters * 100ms + 400ms animation)

                  // After 4 seconds, bob the letters up again
                  setTimeout(() => {
                    const letters = output.querySelectorAll('.letter');
                    const outlines = output.querySelectorAll('.letter-outline');

                    // Slide out the logo when text starts animating out
                    if (touchdownLogoLeft) {
                      touchdownLogoLeft.classList.remove("show");
                      touchdownLogoLeft.classList.add("hide");
                    }

                    letters.forEach((letter, index) => {
                      setTimeout(() => {
                        letter.classList.remove('show');
                        letter.classList.add('animate-off');
                      }, index * 50);
                    });

                    outlines.forEach((outline, index) => {
                      setTimeout(() => {
                        outline.classList.remove('show');
                        outline.classList.add('animate-off');
                      }, index * 50);
                    });

                    // Clear everything after animate-off completes
                    setTimeout(() => {
                      output.innerHTML = "";
                      touchdownAnimationPlaying = false;
                    }, 900); // 9 letters * 50ms + 400ms animation
                  }, 6000); // 1s for initial animation + 5s freeze
                }

                // Function to update bracket team names
                function updateBracketTeamNames(bracketTeams) {
                  if (!bracketTeams || !Array.isArray(bracketTeams)) return;

                  // Update all 24 team slots (12 games x 2 teams each)
                  for (let i = 0; i < 24 && i < bracketTeams.length; i++) {
                    const teamElement = document.getElementById(`bracketTeam${i + 1}`);
                    if (teamElement && bracketTeams[i]) {
                      teamElement.textContent = bracketTeams[i];
                    }
                  }
                }

                // Function to update bracket team colors based on status
                function updateBracketTeamColors(bracketTeamStatus) {
                  if (!bracketTeamStatus || !Array.isArray(bracketTeamStatus)) return;

                  // Update all 24 team slots
                  for (let i = 0; i < 24 && i < bracketTeamStatus.length; i++) {
                    const teamElement = document.getElementById(`bracketTeam${i + 1}`);
                    if (teamElement) {
                      // Remove existing status classes
                      teamElement.classList.remove('won', 'lost');

                      // Add appropriate class based on status
                      const status = bracketTeamStatus[i];
                      if (status === 'won') {
                        teamElement.classList.add('won');
                      } else if (status === 'lost') {
                        teamElement.classList.add('lost');
                      }
                    }
                  }
                }

                // Function to calculate text width
                function getTextWidth(text, font) {
                  const canvas = document.createElement('canvas');
                  const context = canvas.getContext('2d');
                  context.font = font;
                  const metrics = context.measureText(text);
                  return metrics.width;
                }

                // Function to adjust bracket column widths based on longest team name
                function adjustBracketColumnWidths() {
                  const rounds = document.querySelectorAll('.bracket-round');

                  rounds.forEach((round, roundIndex) => {
                    const teams = round.querySelectorAll('.bracket-team');
                    let maxWidth = 0;

                    // Find the longest team name in this round
                    teams.forEach(team => {
                      const text = team.textContent;
                      // Font should match the CSS: 22px "Times New Roman", letter-spacing 1px
                      const font = '22px "Times New Roman", Times, serif';
                      const textWidth = getTextWidth(text, font);
                      // Add padding (12px * 2) + letter spacing approximation + some buffer
                      const totalWidth = textWidth + 24 + (text.length * 1) + 20;
                      maxWidth = Math.max(maxWidth, totalWidth);
                    });

                    // Set minimum width to ensure readability
                    maxWidth = Math.max(maxWidth, 200);

                    // Apply width to the round column (accounting for padding)
                    round.style.width = `${maxWidth + 60}px`; // 30px padding on each side
                  });
                }

                async function updateScoreboardFromStorage() {
                  let data;

                  // Check if we're in preview mode by looking at URL parameters
                  const urlParams = new URLSearchParams(window.location.search);
                  const isPreview = urlParams.has('preview');

                  if (isPreview) {
                    // In preview mode, use localStorage preview state if available
                    const previewDataRaw = localStorage.getItem('basketballScoreboardPreview');
                    if (previewDataRaw) {
                      data = JSON.parse(previewDataRaw);
                    } else {
                      // Fallback to regular data if preview data not available
                      const dataRaw = localStorage.getItem('basketballScoreboard');
                      if (dataRaw) {
                        data = JSON.Parse(dataRaw);
                      } else {
                        return;
                      }
                    }
                  } else {
                    // Normal mode - get data from server or localStorage
                    // Check if we're in Electron by looking for file:// protocol
                    const isElectron = window.location.protocol === 'file:';

                    if (isElectron) {
                      // In Electron, only use localStorage
                      const dataRaw = localStorage.getItem('basketballScoreboard');
                      if (!dataRaw) return;
                      data = JSON.parse(dataRaw);
                    } else {
                      // In browser, try server first
                      try {
                        const cacheBuster = Date.now();
                        const response = await fetch(`data.php?_=${cacheBuster}`, {
                          cache: 'no-cache',
                          headers: {
                            'Cache-Control': 'no-cache',
                            'Pragma': 'no-cache'
                          }
                        });
                        data = await response.json();
                      } catch (e) {
                        console.warn('Failed to fetch from server, trying localStorage', e);
                        const dataRaw = localStorage.getItem('basketballScoreboard');
                        if (!dataRaw) return;
                        data = JSON.parse(dataRaw);
                      }
                    }
                  }

                  // Update XML debug info if available
                  if (data && data.xmlData) {
                    console.log('[XML DEBUG] Graphics received data:', data.xmlData);
                  }

                  try {

                    if (data.homeName) {
                      const el = document.getElementById('homeNameDisplay').querySelector('.team-name-text');
                      if (el) el.textContent = (data.homeName || '').toUpperCase();
                    }
                    if (data.homeMascot) {
                      const el = document.getElementById('homeMascotDisplay');
                      if (el) el.textContent = (data.homeMascot || '').toUpperCase();
                    }
                    if (typeof data.homeScore !== 'undefined') {
                      const el = document.getElementById('homeScore').querySelector('span');
                      if (el) {
                        // If this is the first load, just set the score without animation
                        if (currentHomeScore === null) {
                          currentHomeScore = data.homeScore;
                          el.textContent = data.homeScore;
                        }
                        // Check if score increased to trigger animation
                        else if (data.homeScore > currentHomeScore) {
                          const scoreIncrease = data.homeScore - currentHomeScore;
                          // Trigger animation immediately
                          triggerScoreAnimation('home', data.homeBgColor || '#c41e3a', data.homeLogo, scoreIncrease);

                          // Update the tracking variable
                          currentHomeScore = data.homeScore;

                          // Set animation flag
                          homeScoreAnimating = true;

                          // Delay score text update until animation overlay fully covers the score (300ms)
                          setTimeout(() => {
                            el.textContent = data.homeScore;
                            homeScoreAnimating = false;
                          }, 300);
                        } else if (!homeScoreAnimating) {
                          // Only update if not currently animating
                          if (data.homeScore !== currentHomeScore) {
                            currentHomeScore = data.homeScore;
                            el.textContent = data.homeScore;
                          }
                        }
                      }
                    }
                    if (data.homeBgColor) {
                      const sq = document.getElementById('homeColorSquare');
                      if (sq) sq.style.backgroundColor = data.homeBgColor;
                      const stripFar = document.getElementById('homeColorStripFarLeft');
                      const stripLeft = document.getElementById('homeColorStripLeft');
                      const stripRight = document.getElementById('homeColorStripRight');
                      if (stripFar) stripFar.style.backgroundColor = data.homeBgColor;
                      if (stripLeft) stripLeft.style.backgroundColor = data.homeBgColor;
                      if (stripRight) stripRight.style.backgroundColor = data.homeBgColor;


                      document.documentElement.style.setProperty('--home-color', data.homeBgColor);
                    }

                    const homeLogoImg = document.getElementById('homeLogoImg');
                    if (homeLogoImg) {
                      if (data.homeLogo && typeof data.homeLogo === 'string' && data.homeLogo.trim() !== '') {
                        console.log('Setting home logo:', data.homeLogo.substring(0, 50) + '...');
                        console.log('Home logo data type:', typeof data.homeLogo);
                        console.log('Home logo starts with data:', data.homeLogo.startsWith('data:'));

                        // Clear any previous error handlers
                        homeLogoImg.onerror = null;
                        homeLogoImg.onload = null;

                        homeLogoImg.onerror = function() {
                          console.error('Failed to load home logo:', this.src.substring(0, 100));
                          this.style.display = 'none';
                        };
                        homeLogoImg.onload = function() {
                          console.log('Home logo loaded successfully');
                          this.style.display = 'block';
                        };

                        // Set the source and display
                        homeLogoImg.src = data.homeLogo;
                        homeLogoImg.style.display = 'block';
                      } else {
                        console.log('No home logo data:', data.homeLogo);
                        homeLogoImg.src = '';
                        homeLogoImg.style.display = 'none';
                      }
                    }

                    if (data.awayName) {
                      const el = document.getElementById('awayNameDisplay').querySelector('.team-name-text');
                      if (el) el.textContent = (data.awayName || '').toUpperCase();
                    }
                    if (data.awayMascot) {
                      const el = document.getElementById('awayMascotDisplay');
                      if (el) el.textContent = (data.awayMascot || '').toUpperCase();
                    }
                    if (typeof data.awayScore !== 'undefined') {
                      const el = document.getElementById('awayScore').querySelector('span');
                      if (el) {
                        // If this is the first load, just set the score without animation
                        if (currentAwayScore === null) {
                          currentAwayScore = data.awayScore;
                          el.textContent = data.awayScore;
                        }
                        // Check if score increased to trigger animation
                        else if (data.awayScore > currentAwayScore) {
                          const scoreIncrease = data.awayScore - currentAwayScore;
                          // Trigger animation immediately
                          triggerScoreAnimation('away', data.awayBgColor || '#006633', data.awayLogo, scoreIncrease);

                          // Update the tracking variable
                          currentAwayScore = data.awayScore;

                          // Set animation flag
                          awayScoreAnimating = true;

                          // Delay score text update until animation overlay fully covers the score (300ms)
                          setTimeout(() => {
                            el.textContent = data.awayScore;
                            awayScoreAnimating = false;
                          }, 300);
                        } else if (!awayScoreAnimating) {
                          // Only update if not currently animating
                          if (data.awayScore !== currentAwayScore) {
                            currentAwayScore = data.awayScore;
                            el.textContent = data.awayScore;
                          }
                        }
                      }
                    }
                    if (data.awayBgColor) {
                      const sq = document.getElementById('awayColorSquare');
                      if (sq) sq.style.backgroundColor = data.awayBgColor;
                      const stripLeft = document.getElementById('awayColorStripLeft');
                      const stripRight = document.getElementById('awayColorStripRight');
                      if (stripLeft) stripLeft.style.backgroundColor = data.awayBgColor;
                      if (stripRight) stripRight.style.backgroundColor = data.awayBgColor;

                      document.documentElement.style.setProperty('--away-color', data.awayBgColor);
                    }

                    const awayLogoImg = document.getElementById('awayLogoImg');
                    if (awayLogoImg) {
                      if (data.awayLogo && typeof data.awayLogo === 'string' && data.awayLogo.trim() !== '') {
                        console.log('Setting away logo:', data.awayLogo.substring(0, 50) + '...');
                        console.log('Away logo data type:', typeof data.awayLogo);
                        console.log('Away logo starts with data:', data.awayLogo.startsWith('data:'));

                        // Clear any previous error handlers
                        awayLogoImg.onerror = null;
                        awayLogoImg.onload = null;

                        awayLogoImg.onerror = function() {
                          console.error('Failed to load away logo:', this.src.substring(0, 100));
                          this.style.display = 'none';
                        };
                        awayLogoImg.onload = function() {
                          console.log('Away logo loaded successfully');
                          this.style.display = 'block';
                        };

                        // Set the source and display
                        awayLogoImg.src = data.awayLogo;
                        awayLogoImg.style.display = 'block';
                      } else {
                        console.log('No away logo data:', data.awayLogo);
                        awayLogoImg.src = '';
                        awayLogoImg.style.display = 'none';
                      }
                    }

                    if (data.period) {
                      const el = document.getElementById('periodDisplay');
                      if (el) {
                        const normalizedPeriod = normalizePeriod(data.period);
                        el.textContent = normalizedPeriod;

                        // Make HALF and FINAL slightly smaller
                        if (normalizedPeriod === 'HALF' || normalizedPeriod === 'FINAL') {
                          el.style.fontSize = '24px';
                        } else {
                          el.style.fontSize = '30px';
                        }
                      }
                    }
                    if (data.clockTime && data.clockTime !== lastClockUpdate) {
                      const el = document.getElementById('clockDisplay');
                      if (el) {
                        const formattedTime = formatClockTime(data.clockTime);
                        el.textContent = formattedTime;
                        lastClockUpdate = data.clockTime;
                      }
                    }

                    // Timeout handling (supports both "Left" or "Used" keys)
                    updateTimeoutRects(data);

                    // Handle scorebar visibility
                    updateScorebarVisibility(data);

                    // Check for touchdown animation trigger
                    if (data.touchdownTriggered === true && !touchdownAnimationPlaying) {
                      showTouchdownAnimation();
                    }

                    // Handle locator visibility
                    updateLocatorVisibility(data);

                    // Handle stat display visibility
                    updateStatDisplayVisibility(data);

                    // Handle mini bug data
                    updateMiniBugData(data);

                    // Handle mini locator data
                    updateMiniLocatorData(data);

                    // Handle tombstone data
                    updateTombstoneData(data);

                    // Handle talent locator data
                    updateTalentLocatorData(data);

                    // Handle tombstone visibility and data
                    updateTombstoneVisibility(data);

                    // Handle ticker data
                    updateTickerData(data);

                    // Handle football data
                    updateFootballData(data);

                    // Handle left slab visibility
                    updateLeftSlabVisibility(data);

                    // Handle flag visibility
                    updateFlagVisibility(data);

                    // Handle volleyball sets
                    updateVolleyballSets(data);

                    // Update sport mode class on scorebar
                    updateSportMode(data);

                    // Update fullscreen square visibility
                    updateFullscreenSquareVisibility(data);

                    // Update bracket team names
                    if (data.bracketTeams) {
                      updateBracketTeamNames(data.bracketTeams);
                    }

                    // Update bracket team colors based on status
                    if (data.bracketTeamStatus) {
                      updateBracketTeamColors(data.bracketTeamStatus);
                    }

                    // Adjust column widths based on longest team names
                    adjustBracketColumnWidths();

                  } catch (e) {
                    console.warn('Invalid scoreboard data:', e);
                  }
                }

                // Track flag state independently
                let flagCurrentlyVisible = false;
                let flagAnimating = false;

                // Track timeout states for flash animation
                let lastHomeTimeouts = null;
                let lastAwayTimeouts = null;

                function updateFlagVisibility(data) {
                  const flagPulse = document.getElementById('flagPulse');
                  const isFlagVisible = data.flagVisible === true; // Assumes flagVisible is a boolean in the data

                  if (isFlagVisible && !flagCurrentlyVisible && !flagAnimating) {
                    // Start pulse in animation
                    flagAnimating = true;
                    flagPulse.classList.remove('flag-animate-in', 'flag-animate-out');
                    void flagPulse.offsetWidth; // Force reflow
                    flagPulse.classList.add('flag-animate-in');
                  } else if (!isFlagVisible && flagCurrentlyVisible && !flagAnimating) {
                    // Start pulse out animation
                    flagAnimating = true;
                    flagPulse.classList.remove('flag-animate-in', 'flag-animate-out');
                    void flagPulse.offsetWidth; // Force reflow
                    flagPulse.classList.add('flag-animate-out');
                  }
                }

                // Add event listener for animation end
                document.addEventListener('DOMContentLoaded', function() {
                  const flagPulse = document.getElementById('flagPulse');
                  if (flagPulse) {
                    flagPulse.addEventListener('animationend', (e) => {
                      flagPulse.classList.remove('flag-animate-in', 'flag-animate-out');
                      flagAnimating = false;
                      if (e.animationName === 'pulseIn') {
                        flagPulse.classList.add('flag-visible');
                        flagCurrentlyVisible = true;
                      } else if (e.animationName === 'pulseOut') {
                        flagPulse.classList.remove('flag-visible');
                        flagCurrentlyVisible = false;
                      }
                    });
                  }
                });

                function updateTimeoutRects(data) {
                  // Determine max timeouts based on sport
                  const isFootball = data.selectedSport === 'football';
                  const isVolleyball = data.selectedSport === 'volleyball';

                  let maxTimeouts;
                  if (isVolleyball) {
                    maxTimeouts = MAX_TIMEOUTS_VOLLEYBALL;
                  } else if (isFootball) {
                    maxTimeouts = MAX_TIMEOUTS_FOOTBALL;
                  } else {
                    maxTimeouts = MAX_TIMEOUTS;
                  }

                  // Show/hide football section based on sport
                  const footballSection = document.getElementById('footballSection');
                  const footballSectionSeparator = document.getElementById('footballSectionSeparator');

                  if (isFootball) {
                    if (footballSection) footballSection.style.display = 'flex';
                    if (footballSectionSeparator) footballSectionSeparator.style.display = 'block';
                  } else {
                    if (footballSection) footballSection.style.display = 'none';
                    if (footballSectionSeparator) footballSectionSeparator.style.display = 'none';
                  }

                  let homeLeft;
                  if (typeof data.homeTimeoutsLeft !== 'undefined') {
                    homeLeft = clampInt(data.homeTimeoutsLeft, 0, maxTimeouts);
                  } else if (typeof data.homeTimeoutsUsed !== 'undefined') {
                    homeLeft = clampInt(maxTimeouts - Number(data.homeTimeoutsUsed), 0, maxTimeouts);
                  } else {
                    homeLeft = maxTimeouts;
                  }

                  let awayLeft;
                  if (typeof data.awayTimeoutsLeft !== 'undefined') {
                    awayLeft = clampInt(data.awayTimeoutsLeft, 0, maxTimeouts);
                  } else if (typeof data.awayTimeoutsUsed !== 'undefined') {
                    awayLeft = clampInt(maxTimeouts - Number(data.awayTimeoutsUsed), 0, maxTimeouts);
                  } else {
                    awayLeft = maxTimeouts;
                  }

                  homeLeft = clampInt(homeLeft, 0, maxTimeouts);
                  awayLeft = clampInt(awayLeft, 0, maxTimeouts);

                  // Check for timeout changes to trigger flash animation
                  let homeTimeoutTaken = false;
                  let awayTimeoutTaken = false;

                  if (lastHomeTimeouts !== null && homeLeft < lastHomeTimeouts) {
                    homeTimeoutTaken = true;
                  }
                  if (lastAwayTimeouts !== null && awayLeft < lastAwayTimeouts) {
                    awayTimeoutTaken = true;
                  }

                  lastHomeTimeouts = homeLeft;
                  lastAwayTimeouts = awayLeft;

                  // Handle football timeout squares
                  if (isFootball) {
                    const homeFootballTimeouts = document.getElementById('homeFootballTimeouts');
                    const awayFootballTimeouts = document.getElementById('awayFootballTimeouts');

                    if (homeFootballTimeouts) {
                      homeFootballTimeouts.style.display = 'flex';
                      const homeSquares = homeFootballTimeouts.querySelectorAll('.football-timeout-square');
                      const homeUsed = maxTimeouts - homeLeft; // Number of timeouts used
                      homeSquares.forEach((square, index) => {
                        if (index < homeUsed) {
                          // Flash the most recently used timeout
                          if (homeTimeoutTaken && index === homeUsed - 1) {
                            square.classList.remove('used');
                            square.classList.add('flashing');
                            setTimeout(() => {
                              square.classList.remove('flashing');
                              square.classList.add('used');
                            }, 1200);
                          } else {
                            square.classList.add('used');
                          }
                        } else {
                          square.classList.remove('used');
                        }
                      });
                    }

                    if (awayFootballTimeouts) {
                      awayFootballTimeouts.style.display = 'flex';
                      const awaySquares = awayFootballTimeouts.querySelectorAll('.football-timeout-square');
                      const awayUsed = maxTimeouts - awayLeft; // Number of timeouts used
                      awaySquares.forEach((square, index) => {
                        if (index < awayUsed) {
                          // Flash the most recently used timeout
                          if (awayTimeoutTaken && index === awayUsed - 1) {
                            square.classList.remove('used');
                            square.classList.add('flashing');
                            setTimeout(() => {
                              square.classList.remove('flashing');
                              square.classList.add('used');
                            }, 1200);
                          } else {
                            square.classList.add('used');
                          }
                        } else {
                          square.classList.remove('used');
                        }
                      });
                    }
                  } else {
                    // Hide football timeout squares for other sports
                    const homeFootballTimeouts = document.getElementById('homeFootballTimeouts');
                    const awayFootballTimeouts = document.getElementById('awayFootballTimeouts');
                    if (homeFootballTimeouts) homeFootballTimeouts.style.display = 'none';
                    if (awayFootballTimeouts) awayFootballTimeouts.style.display = 'none';
                  }

                  const homeRects = Array.from(document.querySelectorAll('.lower-scorebar.first .rect'));
                  const awayRects = Array.from(document.querySelectorAll('.lower-scorebar.second .rect'));

                  // Show/hide rectangles based on sport and apply football styling
                  for (let i = 0; i < homeRects.length; i++) {
                    if (i < maxTimeouts && !isFootball) { // Hide rectangles for football
                      homeRects[i].style.display = 'block';

                      // Add or remove volleyball-mode class based on sport
                      if (isVolleyball) {
                        homeRects[i].classList.add('volleyball-mode');
                      } else {
                        homeRects[i].classList.remove('volleyball-mode');
                      }

                      if (i < homeLeft) {
                        homeRects[i].classList.remove('used');
                      } else {
                        // Flash the most recently used timeout
                        if (homeTimeoutTaken && i === homeLeft) {
                          homeRects[i].classList.remove('used');
                          homeRects[i].classList.add('flashing');
                          setTimeout(() => {
                            homeRects[i].classList.remove('flashing');
                            homeRects[i].classList.add('used');
                          }, 1200);
                        } else {
                          homeRects[i].classList.add('used');
                        }
                      }
                    } else {
                      homeRects[i].style.display = 'none';
                      homeRects[i].classList.remove('football-mode');
                    }
                  }

                  for (let i = 0; i < awayRects.length; i++) {
                    if (i < maxTimeouts && !isFootball) { // Hide rectangles for football
                      awayRects[i].style.display = 'block';

                      // Add or remove volleyball-mode class based on sport
                      if (isVolleyball) {
                        awayRects[i].classList.add('volleyball-mode');
                      } else {
                        awayRects[i].classList.remove('volleyball-mode');
                      }

                      if (i < awayLeft) {
                        awayRects[i].classList.remove('used');
                      } else {
                        // Flash the most recently used timeout
                        if (awayTimeoutTaken && i === awayLeft) {
                          awayRects[i].classList.remove('used');
                          awayRects[i].classList.add('flashing');
                          setTimeout(() => {
                            awayRects[i].classList.remove('flashing');
                            awayRects[i].classList.add('used');
                          }, 1200);
                        } else {
                          awayRects[i].classList.add('used');
                        }
                      }
                    } else {
                      awayRects[i].style.display = 'none';
                      awayRects[i].classList.remove('football-mode');
                    }
                  }

                  // Handle sport mode classes for all lower scorebar elements
                  const lowerElements = [
                    '.lower-scorebar.first',
                    '.lower-scorebar.second',
                    '.lower-scorebar.third',
                    '.lower-separator-left',
                    '.lower-separator-right',
                    '.lower-white-block',
                    '.lower-separator-right-2',
                    '.lower-separator-after-second',
                    '.lower-white-block.after-second',
                    '.lower-separator-after-white',
                    '.lower-separator-after-third'
                  ];

                  lowerElements.forEach(selector => {
                    const element = document.querySelector(selector);
                    if (element) {
                      // Remove all sport mode classes first
                      element.classList.remove('football-mode', 'volleyball-mode');

                      // Add appropriate sport mode class
                      if (isFootball) {
                        element.classList.add('football-mode');
                      } else if (isVolleyball) {
                        element.classList.add('volleyball-mode');
                      }
                    }
                  });
                }

                function updateScorebarVisibility(data) {
                  const isVisible = data.scorebarVisible !== false; // default to visible if not specified

                  const scorebar = document.querySelector('.scorebar');
                  const lowerElements = [
                    '.lower-scorebar.first',
                    '.lower-scorebar.second',
                    '.lower-scorebar.third',
                    '.lower-separator-left',
                    '.lower-separator-right',
                    '.lower-white-block',
                    '.lower-separator-right-2',
                    '.lower-separator-after-second',
                    '.lower-white-block.after-second',
                    '.lower-separator-after-white',
                    '.lower-separator-after-third'
                  ];

                  if (isVisible) {
                    if (scorebar) scorebar.classList.remove('hidden');
                    lowerElements.forEach(selector => {
                      const el = document.querySelector(selector);
                      if (el) el.classList.remove('hidden');
                    });
                  } else {
                    if (scorebar) scorebar.classList.add('hidden');
                    lowerElements.forEach(selector => {
                      const el = document.querySelector(selector);
                      if (el) el.classList.add('hidden');
                    });
                  }
                }

                function updateStatDisplayVisibility(data) {
                  const statsRectangle = document.getElementById('statsRectangle');
                  const statsLabel = document.getElementById('statsLabel');
                  const statsDataHome = document.getElementById('statsDataHome');
                  const statsDataAway = document.getElementById('statsDataAway');

                  const isVisible = data.statDisplayVisible === true;
                  const scorebarVisible = data.scorebarVisible !== false; // Check if scorebar is visible

                  console.log('[STAT DEBUG] updateStatDisplayVisibility called:');
                  console.log('  - isVisible (statDisplayVisible === true):', isVisible);
                  console.log('  - scorebarVisible:', scorebarVisible);
                  console.log('  - data.statDisplayVisible:', data.statDisplayVisible);
                  console.log('  - currentDisplayedStat:', data.currentDisplayedStat);
                  console.log('  - hasFootballStats:', !!data.footballStats);
                  console.log('  - hasVolleyballStats:', !!data.volleyballStats);
                  console.log('  - hasBasketballStats:', !!data.basketballStats);
                  console.log('  - footballStats:', data.footballStats);
                  console.log('  - volleyballStats:', data.volleyballStats);
                  console.log('  - basketballStats:', data.basketballStats);
                  console.log('  - statsRectangleExists:', !!statsRectangle);

                  if (!statsRectangle) {
                    console.warn('[STAT DEBUG] Stats rectangle not found!');
                    return;
                  }

                  // Determine which stats object to use based on sport
                  let stats;
                  if (data.selectedSport === 'volleyball') {
                    stats = data.volleyballStats;
                  } else if (data.selectedSport === 'basketball') {
                    stats = data.basketballStats;
                  } else {
                    stats = data.footballStats;
                  }

                  // Update sport mode class
                  if (data.selectedSport === 'volleyball') {
                    statsRectangle.classList.add('volleyball-mode');
                  } else {
                    statsRectangle.classList.remove('volleyball-mode');
                  }

                  // Only show stats if both statDisplayVisible is true AND scorebar is visible
                  if (isVisible && scorebarVisible && data.currentDisplayedStat && stats && stats[data.currentDisplayedStat]) {
                    const stat = stats[data.currentDisplayedStat];
                    const statName = getStatDisplayName(data.currentDisplayedStat);

                    console.log('[STAT DEBUG] Showing stat:', {
                      statName,
                      home: stat.home,
                      away: stat.away,
                      sport: data.selectedSport
                    });

                    // Update content
                    if (statsLabel) statsLabel.textContent = statName;
                    if (statsDataHome) statsDataHome.textContent = stat.home || '0';
                    if (statsDataAway) statsDataAway.textContent = stat.away || '0';

                    // Show rectangle
                    statsRectangle.classList.add('visible');
                    console.log('[STAT DEBUG] Added visible class, classes:', statsRectangle.className);
                  } else {
                    // Hide rectangle
                    statsRectangle.classList.remove('visible');
                    console.log('[STAT DEBUG] Removed visible class');
                  }
                }

                function getStatDisplayName(statKey) {
                  const statNames = {
                    'turnovers': 'Turnovers',
                    'fumbles': 'Fumbles',
                    'penalties': 'Penalties',
                    'sacks': 'Sacks',
                    'interceptions': 'Interceptions',
                    'timeOfPossession': 'Time of Possession',
                    'thirdDownConversions': '3rd Down Conversions',
                    'fourthDownConversions': '4th Down Conversions',
                    'totalYards': 'Total Yards',
                    'passingYards': 'Passing Yards',
                    'rushingYards': 'Rushing Yards',
                    'rushing_yards': 'Rushing Yards',
                    'passing_yards': 'Passing Yards',
                    'total_yards': 'Total Yards',
                    'touchdowns': 'Touchdowns',
                    'field_goals': 'Field Goals',
                    'first_downs': 'First Downs',
                    'penalty_yards': 'Penalty Yards',
                    'time_of_possession': 'Time of Possession',
                    'setsWon': 'Sets Won - Best of 5',
                    'sets_Won': 'Sets Won - Best of 5',
                    'kills': 'Kills',
                    'digs': 'Digs',
                    'blocks': 'Blocks',
                    'aces': 'Aces',
                    'assists': 'Assists',
                    'errors': 'Errors',
                    'hitting_percentage': 'Hitting %',
                    'service_errors': 'Service Errors',
                    'points': 'Points',
                    'rebounds': 'Rebounds',
                    'steals': 'Steals',
                    'field_goal_pct': 'Field Goal %',
                    'three_pointers': '3-Pointers Made',
                    'three_point_pct': '3-Point %',
                    'free_throws': 'Free Throws',
                    'free_throw_pct': 'Free Throw %',
                    'fouls': 'Fouls'
                  };
                  return statNames[statKey] || statKey.charAt(0).toUpperCase() + statKey.slice(1);
                }

                function updateLocatorVisibility(data) {
                  const locatorWrapper = document.querySelector('.locator-wrapper');
                  const isVisible = data.locatorVisible === true;

                  if (isVisible) {
                    if (locatorWrapper) locatorWrapper.classList.remove('hidden');
                  } else {
                    if (locatorWrapper) locatorWrapper.classList.add('hidden');
                    return;
                  }

                  // Update team colors when visible
                  if (isVisible) {
                    if (locatorTeamColorLeft && data.homeBgColor) {
                      locatorTeamColorLeft.style.backgroundColor = data.homeBgColor;
                    }
                    if (locatorTeamColorRight && data.awayBgColor) {
                      locatorTeamColorRight.style.backgroundColor = data.awayBgColor;
                    }
                    if (locatorTeamColorStripLeft && data.homeBgColor) {
                      locatorTeamColorStripLeft.style.backgroundColor = data.homeBgColor;
                    }
                    if (locatorTeamColorStripRight && data.awayBgColor) {
                      locatorTeamColorStripRight.style.backgroundColor = data.awayBgColor;
                    }
                    if (locatorTeamColorInnerStripLeft && data.homeBgColor) {
                      locatorTeamColorInnerStripLeft.style.backgroundColor = data.homeBgColor;
                    }
                    if (locatorTeamColorInnerStripRight && data.awayBgColor) {
                      locatorTeamColorInnerStripRight.style.backgroundColor = data.awayBgColor;
                    }

                    // Update logos
                    const locatorHomeLogoImg = document.getElementById('locatorHomeLogoImg');
                    if (locatorHomeLogoImg) {
                      if (data.homeLogo && typeof data.homeLogo === 'string' && data.homeLogo.trim() !== '') {
                        locatorHomeLogoImg.onerror = function() {
                          this.style.display = 'none';
                        };
                        locatorHomeLogoImg.onload = function() {
                          this.style.display = 'block';
                        };
                        locatorHomeLogoImg.src = data.homeLogo;
                        locatorHomeLogoImg.style.display = 'block';
                      } else {
                        locatorHomeLogoImg.src = '';
                        locatorHomeLogoImg.style.display = 'none';
                      }
                    }

                    const locatorAwayLogoImg = document.getElementById('locatorAwayLogoImg');
                    if (locatorAwayLogoImg) {
                      if (data.awayLogo && typeof data.awayLogo === 'string' && data.awayLogo.trim() !== '') {
                        locatorAwayLogoImg.onerror = function() {
                          this.style.display = 'none';
                        };
                        locatorAwayLogoImg.onload = function() {
                          this.style.display = 'block';
                        };
                        locatorAwayLogoImg.src = data.awayLogo;
                        locatorAwayLogoImg.style.display = 'block';
                      } else {
                        locatorAwayLogoImg.src = '';
                        locatorAwayLogoImg.style.display = 'none';
                      }
                    }

                    // Update team names and mascots
                    const locatorHomeName = document.getElementById('locatorHomeName');
                    const locatorHomeMascot = document.getElementById('locatorHomeMascot');
                    const locatorAwayName = document.getElementById('locatorAwayName');
                    const locatorAwayMascot = document.getElementById('locatorAwayMascot');

                    if (locatorHomeName && data.homeFullName) {
                      locatorHomeName.textContent = data.homeFullName.toUpperCase();
                    }
                    if (locatorHomeMascot && data.homeMascot) {
                      locatorHomeMascot.textContent = data.homeMascot.toUpperCase();
                    }
                    if (locatorAwayName && data.awayFullName) {
                      locatorAwayName.textContent = data.awayFullName.toUpperCase();
                    }
                    if (locatorAwayMascot && data.awayMascot) {
                      locatorAwayMascot.textContent = data.awayMascot.toUpperCase();
                    }
                  }
                }

                function updateMiniLocatorData(data) {
                  const miniLocatorWrapper = document.querySelector('.mini-locator-wrapper');

                  // Handle mini locator visibility (defaults to hidden)
                  const lowerThirdVisible = data.lowerThirdVisible === true; // default to hidden

                  if (lowerThirdVisible) {
                    if (miniLocatorWrapper) miniLocatorWrapper.classList.remove('hidden');
                  } else {
                    if (miniLocatorWrapper) miniLocatorWrapper.classList.add('hidden');
                    return;
                  }

                  // Update team colors when visible based on selected team
                  const selectedTeam = data.lowerThirdTeam || 'home'; // default to home
                  let teamBgColor, teamLogo;

                  if (selectedTeam === 'csn') {
                    teamBgColor = '#ffffff'; // white for CSN
                    teamLogo = data.tickerLogo || ''; // Use ticker logo
                  } else if (selectedTeam === 'home') {
                    teamBgColor = data.homeBgColor;
                    teamLogo = data.homeLogo;
                  } else {
                    teamBgColor = data.awayBgColor;
                    teamLogo = data.awayLogo;
                  }

                  const miniLocatorTeamColorLeft = document.getElementById('miniLocatorTeamColorLeft');
                  const miniLocatorTeamColorStripLeft = document.getElementById('miniLocatorTeamColorStripLeft');
                  const miniLocatorTeamColorInnerStripLeft = document.getElementById('miniLocatorTeamColorInnerStripLeft');

                  if (miniLocatorTeamColorLeft && teamBgColor) {
                    miniLocatorTeamColorLeft.style.backgroundColor = teamBgColor;
                  }
                  if (miniLocatorTeamColorStripLeft && teamBgColor) {
                    miniLocatorTeamColorStripLeft.style.backgroundColor = teamBgColor;
                  }
                  if (miniLocatorTeamColorInnerStripLeft && teamBgColor) {
                    miniLocatorTeamColorInnerStripLeft.style.backgroundColor = teamBgColor;
                  }

                  // Update logo
                  const miniLocatorHomeLogoImg = document.getElementById('miniLocatorHomeLogoImg');
                  if (miniLocatorHomeLogoImg) {
                    if (teamLogo && typeof teamLogo === 'string' && teamLogo.trim() !== '') {
                      miniLocatorHomeLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      miniLocatorHomeLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      miniLocatorHomeLogoImg.src = teamLogo;
                      miniLocatorHomeLogoImg.style.display = 'block';
                    } else {
                      miniLocatorHomeLogoImg.src = '';
                      miniLocatorHomeLogoImg.style.display = 'none';
                    }
                  }

                  // Update name and title
                  const miniLocatorHomeName = document.getElementById('miniLocatorHomeName');
                  const miniLocatorHomeMascot = document.getElementById('miniLocatorHomeMascot');

                  if (miniLocatorHomeName && data.lowerThirdTitle) {
                    miniLocatorHomeName.textContent = data.lowerThirdTitle.toUpperCase();
                  }
                  if (miniLocatorHomeMascot && data.lowerThirdName) {
                    miniLocatorHomeMascot.textContent = data.lowerThirdName.toUpperCase();
                  }
                }

                function updateTombstoneVisibility(data) {
                  const tombstoneWrapper = document.querySelector('.tombstone-wrapper');
                  const tombstoneVisible = data.tombstoneVisible === true;

                  if (tombstoneVisible) {
                    if (tombstoneWrapper) tombstoneWrapper.classList.remove('hidden');
                    updateTombstoneData(data);
                    updateTombstoneHeight(data); // Call the new height function
                  } else {
                    if (tombstoneWrapper) tombstoneWrapper.classList.add('hidden');
                  }
                }

                function updateTombstoneWeatherDisplay(data) {
                  const container = document.getElementById('tombstoneSectionsContainer');
                  if (!container) return;

                  // Clear existing sections
                  container.innerHTML = '';

                  // Get current weather data or use defaults
                  const temperature = data.weatherTemp || '72F';
                  const feelsLike = data.weatherFeelsLike || '75F';
                  const humidity = data.weatherHumidity || '65%';
                  const windSpeed = data.weatherWind || '8 mph NW';
                  const uvIndex = data.weatherUVIndex || '3/11';

                  // Set fixed height for weather display
                  const requiredHeight = 175;

                  // Start position below the inner strip, accounting for height changes
                  const baseHeight = 80;
                  const heightDifference = requiredHeight - baseHeight;
                  let sectionTopPosition = -50 - heightDifference + 30;

                  // Temperature
                  const tempElement = document.createElement('div');
                  tempElement.style.cssText = `
                    position: absolute;
                    left: 42px;
                    top: ${sectionTopPosition}px;
                    width: 330px;
                    background: transparent;
                    border: none;
                    z-index: 11405;
                    pointer-events: none;
                    display: flex;
                    gap: 180px;
                    color: #fff;
                    font-family: "Times New Roman", Times, serif;
                    font-weight: bold;
                    letter-spacing: 3px;
                    font-size: 16px;
                    text-align: left;
                    text-transform: uppercase;
                  `;
                  // Extract just the number if F is already included, otherwise use as-is
                  const tempValue = temperature.toString().includes('F') ? temperature : `${temperature}F`;
                  tempElement.innerHTML = `<span style="flex: 0 0 120px;">Temperature:</span><span style="text-align: right; flex: 1;">${tempValue}</span>`;
                  container.appendChild(tempElement);
                  sectionTopPosition += 22;

                  // Feels like temperature
                  const feelsLikeElement = document.createElement('div');
                  feelsLikeElement.style.cssText = `
                    position: absolute;
                    left: 42px;
                    top: ${sectionTopPosition}px;
                    width: 330px;
                    background: transparent;
                    border: none;
                    z-index: 11405;
                    pointer-events: none;
                    display: flex;
                    gap: 164px;
                    color: #fff;
                    font-family: "Times New Roman", Times, serif;
                    font-weight: bold;
                    letter-spacing: 3px;
                    font-size: 16px;
                    text-align: left;
                    text-transform: uppercase;
                  `;
                  // Extract just the number if F is already included, otherwise use as-is
                  const feelsLikeValue = feelsLike.toString().includes('F') ? feelsLike : `${feelsLike}F`;
                  feelsLikeElement.innerHTML = `<span style="flex: 0 0 180px;">Feels Like:</span><span style="text-align: right; flex: 1;">${feelsLikeValue}</span>`;
                  container.appendChild(feelsLikeElement);
                  sectionTopPosition += 22;

                  // Humidity - ensure number is displayed with %
                  const humidityElement = document.createElement('div');
                  humidityElement.style.cssText = `
                    position: absolute;
                    left: 42px;
                    top: ${sectionTopPosition}px;
                    width: 330px;
                    background: transparent;
                    border: none;
                    z-index: 11405;
                    pointer-events: none;
                    display: flex;
                    gap: 228px;
                    color: #fff;
                    font-family: "Times New Roman", Times, serif;
                    font-weight: bold;
                    letter-spacing: 3px;
                    font-size: 16px;
                    text-align: left;
                    text-transform: uppercase;
                  `;
                  // Extract just the number if % is already included, otherwise use as-is
                  const humidityValue = humidity.toString().includes('%') ? humidity : `${humidity}%`;
                  humidityElement.innerHTML = `<span style="flex: 0 0 120px;">Humidity:</span><span style="text-align: right; flex: 1;">${humidityValue}</span>`;
                  container.appendChild(humidityElement);
                  sectionTopPosition += 22;

                  // Wind
                  const windElement = document.createElement('div');
                  windElement.style.cssText = `
                    position: absolute;
                    left: 42px;
                    top: ${sectionTopPosition}px;
                    width: 388px;
                    background: transparent;
                    border: none;
                    z-index: 11405;
                    pointer-events: none;
                    display: flex;
                    gap: 100px;
                    color: #fff;
                    font-family: "Times New Roman", Times, serif;
                    font-weight: bold;
                    letter-spacing: 3px;
                    font-size: 16px;
                    text-align: left;
                    text-transform: uppercase;
                  `;
                  windElement.innerHTML = `<span style="flex: 0 0 150px;">Wind:</span><span style="text-align: right; flex: 1;">${windSpeed}</span>`;
                  container.appendChild(windElement);
                  sectionTopPosition += 22;

                  // UV Index - ensure number is displayed with /11
                  const uvElement = document.createElement('div');
                  uvElement.style.cssText = `
                    position: absolute;
                    left: 42px;
                    top: ${sectionTopPosition}px;
                    width: 388px;
                    background: transparent;
                    border: none;
                    z-index: 11405;
                    pointer-events: none;
                    display: flex;
                    gap: 200px;
                    color: #fff;
                    font-family: "Times New Roman", Times, serif;
                    font-weight: bold;
                    letter-spacing: 3px;
                    font-size: 16px;
                    text-align: left;
                    text-transform: uppercase;
                  `;
                  // Extract just the number if /11 is already included, otherwise use as-is
                  const uvValue = uvIndex.toString().includes('/11') ? uvIndex : `${uvIndex}/11`;
                  uvElement.innerHTML = `<span style="flex: 0 0 120px;">UV Index:</span><span style="text-align: right; flex: 1;">${uvValue}</span>`;
                  container.appendChild(uvElement);
                }

                function updateTombstoneData(data) {
                  // Update team colors when visible based on selected team
                  const selectedTeam = data.tombstoneTeam || 'home'; // default to home
                  let teamBgColor, teamLogo;

                  if (selectedTeam === 'weather') {
                    teamBgColor = '#20A7DB'; // blue for weather
                    teamLogo = '../../IMAGES/cloudy.png'; // weather icon image
                  } else if (selectedTeam === 'home') {
                    teamBgColor = data.homeBgColor;
                    teamLogo = data.homeLogo;
                  } else {
                    teamBgColor = data.awayBgColor;
                    teamLogo = data.awayLogo;
                  }

                  const tombstoneTeamColorLeft = document.getElementById('tombstoneTeamColorLeft');
                  const tombstoneTeamColorStripLeft = document.getElementById('tombstoneTeamColorStripLeft');
                  const tombstoneTeamColorInnerStripLeft = document.getElementById('tombstoneTeamColorInnerStripLeft');

                  if (tombstoneTeamColorLeft && teamBgColor) {
                    tombstoneTeamColorLeft.style.backgroundColor = teamBgColor;
                  }
                  if (tombstoneTeamColorStripLeft && teamBgColor) {
                    tombstoneTeamColorStripLeft.style.backgroundColor = teamBgColor;
                  }
                  if (tombstoneTeamColorInnerStripLeft && teamBgColor) {
                    tombstoneTeamColorInnerStripLeft.style.backgroundColor = teamBgColor;
                  }

                  // Update logo
                  const tombstoneHomeLogoImg = document.getElementById('tombstoneHomeLogoImg');
                  if (tombstoneHomeLogoImg) {
                    if (teamLogo && typeof teamLogo === 'string' && teamLogo.trim() !== '') {
                      tombstoneHomeLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      tombstoneHomeLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      tombstoneHomeLogoImg.src = teamLogo;
                      tombstoneHomeLogoImg.style.display = 'block';
                    } else {
                      tombstoneHomeLogoImg.src = '';
                      tombstoneHomeLogoImg.style.display = 'none';
                    }
                  }

                  // Update tombstone sections display - show weather data for weather team, otherwise show custom sections
                  if (selectedTeam === 'weather') {
                    updateTombstoneWeatherDisplay(data);
                  } else {
                    updateTombstoneSections(data);
                  }

                  // Update name and title, and show team name based on selected team
                  const tombstoneHomeName = document.getElementById('tombstoneHomeName');
                  const tombstoneHomeMascot = document.getElementById('tombstoneHomeMascot');

                  // Display team name based on selected team
                  let teamName = '';
                  if (selectedTeam === 'weather') {
                    teamName = 'WEATHER';
                  } else if (selectedTeam === 'home' && data.homeName) {
                    teamName = data.homeName.toUpperCase();
                  } else if (selectedTeam === 'away' && data.awayName) {
                    teamName = data.awayName.toUpperCase();
                  }

                  // Display team mascot based on selected team
                  let teamMascot = '';
                  if (selectedTeam === 'weather') {
                    teamMascot = 'UPDATE';
                  } else if (selectedTeam === 'home' && data.homeMascot) {
                    teamMascot = data.homeMascot.toUpperCase();
                  } else if (selectedTeam === 'away' && data.awayMascot) {
                    teamMascot = data.awayMascot.toUpperCase();
                  }

                  if (tombstoneHomeName) {
                    if (data.tombstoneTitle) {
                      tombstoneHomeName.textContent = data.tombstoneTitle.toUpperCase();
                    } else {
                      tombstoneHomeName.textContent = teamName;
                    }
                  }
                  if (tombstoneHomeMascot) {
                    tombstoneHomeMascot.textContent = teamMascot;
                  }
                }

                function updateTombstoneSections(data) {
                  const container = document.getElementById('tombstoneSectionsContainer');
                  if (!container) return;

                  // Clear existing sections
                  container.innerHTML = '';

                  if (data.tombstoneSections && Array.isArray(data.tombstoneSections)) {
                    // Calculate the required height based on sections first
                    const validSections = data.tombstoneSections.filter(section => section.title && section.title.trim());
                    let requiredHeight = 80; // Minimum height

                    if (validSections.length > 0) {
                      const additionalHeight = validSections.length * 20;
                      requiredHeight = Math.max(80, 100 + additionalHeight);
                    }

                    // Calculate the height difference from base height
                    const baseHeight = 80;
                    const heightDifference = requiredHeight - baseHeight;

                    // Start position below the inner strip, accounting for height changes
                    let sectionTopPosition = - 50 - heightDifference + 30; // Start below the inner color strip

                    data.tombstoneSections.forEach((section, index) => {
                      // Skip empty sections
                      if (!section.title) return;

                      const sectionElement = document.createElement('div');
                      sectionElement.className = 'tombstone-section';
                      sectionElement.style.cssText = `
                        position: absolute;
                        left: 42px;
                        top: ${sectionTopPosition}px;
                        width: 330px;
                        background: transparent;
                        border: none;
                        z-index: 11405;
                        pointer-events: none;
                        transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                        display: flex;
                        color: #fff;
                        font-family: Impact, Charcoal, sans-serif;
                        font-weight: 200;
                        font-size: 16px;
                        text-align: left;
                        visibility: hidden;
                      `;

                      sectionElement.innerHTML = `<div style="font-size: 16px; font-weight: 200; text-transform: uppercase;">${section.title}</div>`;
                      container.appendChild(sectionElement);

                      // Force layout calculation and measure actual height
                      sectionElement.offsetHeight; // Force reflow
                      const actualHeight = sectionElement.offsetHeight;

                      // Make element visible again
                      sectionElement.style.visibility = 'visible';

                      // Move to next section position (fixed spacing of 20px between sections)
                      sectionTopPosition += 25;
                    });
                  }
                }

                function updateTombstoneHeight(data) {
                  const tombstone = document.querySelector('.tombstone');
                  const tombstoneLeftSeparator = document.querySelector('.tombstone-separator-left');
                  const tombstoneRightSeparator = document.querySelector('.tombstone-separator-right');
                  const tombstoneTeamColorStripLeft = document.getElementById('tombstoneTeamColorStripLeft');
                  const tombstoneTeamColorLeft = document.getElementById('tombstoneTeamColorLeft');
                  const tombstoneTeamColorInnerStripLeft = document.getElementById('tombstoneTeamColorInnerStripLeft');
                  const tombstoneTeamLogo = document.getElementById('tombstoneTeamLogoLeft');

                  if (!tombstone) return;

                  // Check if weather team is selected
                  const selectedTeam = data.tombstoneTeam || 'home';
                  let requiredHeight;

                  if (selectedTeam === 'weather') {
                    // Fixed height for weather display
                    requiredHeight = 180;
                  } else {
                    // Calculate the required height based on sections for non-weather teams
                    requiredHeight = 80; // Minimum height (base height to accommodate color elements)

                    if (data.tombstoneSections && Array.isArray(data.tombstoneSections)) {
                      const validSections = data.tombstoneSections.filter(section => section.title && section.title.trim());

                      if (validSections.length > 0) {
                        // Each section adds approximately 20px (16px font + 4px gap)
                        const additionalHeight = validSections.length * 21;
                        // Add extra space to ensure sections don't overlap with color elements
                        requiredHeight = Math.max(80, 100 + additionalHeight);
                      }
                    }
                  }

                  // Update tombstone height
                  tombstone.style.height = `${requiredHeight}px`;

                  // Update separator heights to match
                  if (tombstoneLeftSeparator) {
                    tombstoneLeftSeparator.style.height = `${requiredHeight}px`;
                  }
                  if (tombstoneRightSeparator) {
                    tombstoneRightSeparator.style.height = `${requiredHeight}px`;
                  }

                  // Position color elements relative to the new tombstone height
                  // They need to move up when tombstone gets taller to stay at the visual top
                  const baseHeight = 80; // Original tombstone height
                  const heightDifference = requiredHeight - baseHeight;

                  if (tombstoneTeamColorStripLeft) {
                    tombstoneTeamColorStripLeft.style.top = `${-78 - heightDifference}px`;
                  }
                  if (tombstoneTeamColorLeft) {
                    tombstoneTeamColorLeft.style.top = `${-74 - heightDifference}px`;
                  }
                  if (tombstoneTeamColorInnerStripLeft) {
                    tombstoneTeamColorInnerStripLeft.style.top = `${-28 - heightDifference}px`;
                  }
                  if (tombstoneTeamLogo) {
                    tombstoneTeamLogo.style.top = `${-83 - heightDifference}px`;
                  }
                }

                function updateTalentLocatorData(data) {
                  const talentLocatorWrapper = document.querySelector('.talent-locator-wrapper');
                  const talentLocatorRightWrapper = document.querySelector('.talent-locator-right-wrapper');

                  // Handle talent locator visibility (defaults to hidden)
                  const talentVisible = data.talentVisible === true; // default to hidden

                  if (talentVisible) {
                    if (talentLocatorWrapper) talentLocatorWrapper.classList.remove('hidden');
                    if (talentLocatorRightWrapper) talentLocatorRightWrapper.classList.remove('hidden');
                  } else {
                    if (talentLocatorWrapper) talentLocatorWrapper.classList.add('hidden');
                    if (talentLocatorRightWrapper) talentLocatorRightWrapper.classList.add('hidden');
                    return;
                  }

                  // Update team colors when visible - always use white
                  const selectedTeam = data.talentTeam || 'home'; // default to home
                  const teamBgColor = '#ffffff'; // always white
                  const teamLogo = data.tickerLogo || ''; // Always use ticker logo

                  // Update LEFT talent locator
                  const talentLocatorTeamColorLeft = document.getElementById('talentLocatorTeamColorLeft');
                  const talentLocatorTeamColorStripLeft = document.getElementById('talentLocatorTeamColorStripLeft');
                  const talentLocatorTeamColorInnerStripLeft = document.getElementById('talentLocatorTeamColorInnerStripLeft');

                  if (talentLocatorTeamColorLeft && teamBgColor) {
                    talentLocatorTeamColorLeft.style.backgroundColor = teamBgColor;
                  }
                  if (talentLocatorTeamColorStripLeft && teamBgColor) {
                    talentLocatorTeamColorStripLeft.style.backgroundColor = teamBgColor;
                  }
                  if (talentLocatorTeamColorInnerStripLeft && teamBgColor) {
                    talentLocatorTeamColorInnerStripLeft.style.backgroundColor = teamBgColor;
                  }

                  // Update RIGHT talent locator
                  const talentLocatorRightTeamColorRight = document.getElementById('talentLocatorRightTeamColorRight');
                  const talentLocatorRightTeamColorStripRight = document.getElementById('talentLocatorRightTeamColorStripRight');
                  const talentLocatorRightTeamColorInnerStripRight = document.getElementById('talentLocatorRightTeamColorInnerStripRight');

                  if (talentLocatorRightTeamColorRight && teamBgColor) {
                    talentLocatorRightTeamColorRight.style.backgroundColor = teamBgColor;
                  }
                  if (talentLocatorRightTeamColorStripRight && teamBgColor) {
                    talentLocatorRightTeamColorStripRight.style.backgroundColor = teamBgColor;
                  }
                  if (talentLocatorRightTeamColorInnerStripRight && teamBgColor) {
                    talentLocatorRightTeamColorInnerStripRight.style.backgroundColor = teamBgColor;
                  }

                  // Update LEFT logo
                  const talentLocatorHomeLogoImg = document.getElementById('talentLocatorHomeLogoImg');
                  if (talentLocatorHomeLogoImg) {
                    if (teamLogo && typeof teamLogo === 'string' && teamLogo.trim() !== '') {
                      talentLocatorHomeLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      talentLocatorHomeLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      talentLocatorHomeLogoImg.src = teamLogo;
                      talentLocatorHomeLogoImg.style.display = 'block';
                    } else {
                      talentLocatorHomeLogoImg.src = '';
                      talentLocatorHomeLogoImg.style.display = 'none';
                    }
                  }

                  // Update RIGHT logo
                  const talentLocatorRightHomeLogoImg = document.getElementById('talentLocatorRightHomeLogoImg');
                  if (talentLocatorRightHomeLogoImg) {
                    if (teamLogo && typeof teamLogo === 'string' && teamLogo.trim() !== '') {
                      talentLocatorRightHomeLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      talentLocatorRightHomeLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      talentLocatorRightHomeLogoImg.src = teamLogo;
                      talentLocatorRightHomeLogoImg.style.display = 'block';
                    } else {
                      talentLocatorRightHomeLogoImg.src = '';
                      talentLocatorRightHomeLogoImg.style.display = 'none';
                    }
                  }

                  // Update LEFT name and title
                  const talentLocatorHomeName = document.getElementById('talentLocatorHomeName');
                  const talentLocatorHomeMascot = document.getElementById('talentLocatorHomeMascot');

                  if (talentLocatorHomeName && data.talentLeftTitle) {
                    talentLocatorHomeName.textContent = data.talentLeftTitle.toUpperCase();
                  }
                  if (talentLocatorHomeMascot && data.talentLeftName) {
                    talentLocatorHomeMascot.textContent = data.talentLeftName.toUpperCase();
                  }

                  // Update RIGHT name and title
                  const talentLocatorRightHomeName = document.getElementById('talentLocatorRightHomeName');
                  const talentLocatorRightHomeMascot = document.getElementById('talentLocatorRightHomeMascot');

                  if (talentLocatorRightHomeName && data.talentRightTitle) {
                    talentLocatorRightHomeName.textContent = data.talentRightTitle.toUpperCase();
                  }
                  if (talentLocatorRightHomeMascot && data.talentRightName) {
                    talentLocatorRightHomeMascot.textContent = data.talentRightName.toUpperCase();
                  }
                }

                function updateMiniBugData(data) {
                  const miniBug = document.querySelector('.mini-bug');
                  const miniBugLowerElements = [
                    '.mini-bug-lower-separator-left',
                    '.mini-bug-lower.first',
                    '.mini-bug-lower-separator-right',
                    '.mini-bug-lower-white-block',
                    '.mini-bug-lower-separator-after-white',
                    '.mini-bug-lower.second',
                    '.mini-bug-lower-separator-after-second',
                    '.mini-bug-lower-white-block.second',
                    '.mini-bug-lower-separator-final'
                  ];

                  // Handle mini bug visibility (defaults to visible)
                  const miniBugVisible = data.miniBugVisible !== false; // default to visible

                  if (miniBugVisible) {
                    if (miniBug) miniBug.classList.remove('hidden');
                    miniBugLowerElements.forEach(selector => {
                      const el = document.querySelector(selector);
                      if (el) el.classList.remove('hidden');
                    });
                  } else {
                    if (miniBug) miniBug.classList.add('hidden');
                    miniBugLowerElements.forEach(selector => {
                      const el = document.querySelector(selector);
                      if (el) el.classList.add('hidden');
                    });
                    return;
                  }

                  // Update home team data
                  if (data.homeBgColor) {
                    const homeColorSquare = document.getElementById('miniBugHomeColorSquare');
                    if (homeColorSquare) homeColorSquare.style.backgroundColor = data.homeBgColor;
                  }

                  if (typeof data.homeScore !== 'undefined') {
                    const homeScoreEl = document.getElementById('miniBugHomeScore').querySelector('span');
                    if (homeScoreEl) {
                      // If this is the first load, just set the score without animation
                      if (currentMiniBugHomeScore === null) {
                        currentMiniBugHomeScore = data.homeScore;
                        homeScoreEl.textContent = data.homeScore;
                      }
                      // Check if score increased to trigger animation
                      else if (data.homeScore > currentMiniBugHomeScore) {
                        // Update the tracking variable
                        currentMiniBugHomeScore = data.homeScore;
                        
                        // Set animation flag
                        miniBugHomeScoreAnimating = true;
                        
                        // Delay score text update until animation overlay fully covers the score (300ms)
                        setTimeout(() => {
                          homeScoreEl.textContent = data.homeScore;
                          miniBugHomeScoreAnimating = false;
                        }, 300);
                      } else if (!miniBugHomeScoreAnimating) {
                        // Only update if not currently animating
                        if (data.homeScore !== currentMiniBugHomeScore) {
                          currentMiniBugHomeScore = data.homeScore;
                          homeScoreEl.textContent = data.homeScore;
                        }
                      }
                    }
                  }

                  const miniBugHomeLogoImg = document.getElementById('miniBugHomeLogoImg');
                  if (miniBugHomeLogoImg) {
                    if (data.homeLogo && typeof data.homeLogo === 'string' && data.homeLogo.trim() !== '') {
                      miniBugHomeLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      miniBugHomeLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      miniBugHomeLogoImg.src = data.homeLogo;
                      miniBugHomeLogoImg.style.display = 'block';
                    } else {
                      miniBugHomeLogoImg.src = '';
                      miniBugHomeLogoImg.style.display = 'none';
                    }
                  }

                  // Update away team data
                  if (data.awayBgColor) {
                    const awayColorSquare = document.getElementById('miniBugAwayColorSquare');
                    if (awayColorSquare) awayColorSquare.style.backgroundColor = data.awayBgColor;
                  }

                  if (typeof data.awayScore !== 'undefined') {
                    const awayScoreEl = document.getElementById('miniBugAwayScore').querySelector('span');
                    if (awayScoreEl) {
                      // If this is the first load, just set the score without animation
                      if (currentMiniBugAwayScore === null) {
                        currentMiniBugAwayScore = data.awayScore;
                        awayScoreEl.textContent = data.awayScore;
                      }
                      // Check if score increased to trigger animation
                      else if (data.awayScore > currentMiniBugAwayScore) {
                        // Update the tracking variable
                        currentMiniBugAwayScore = data.awayScore;
                        
                        // Set animation flag
                        miniBugAwayScoreAnimating = true;
                        
                        // Delay score text update until animation overlay fully covers the score (300ms)
                        setTimeout(() => {
                          awayScoreEl.textContent = data.awayScore;
                          miniBugAwayScoreAnimating = false;
                        }, 300);
                      } else if (!miniBugAwayScoreAnimating) {
                        // Only update if not currently animating
                        if (data.awayScore !== currentMiniBugAwayScore) {
                          currentMiniBugAwayScore = data.awayScore;
                          awayScoreEl.textContent = data.awayScore;
                        }
                      }
                    }
                  }

                  const miniBugAwayLogoImg = document.getElementById('miniBugAwayLogoImg');
                  if (miniBugAwayLogoImg) {
                    if (data.awayLogo && typeof data.awayLogo === 'string' && data.awayLogo.trim() !== '') {
                      miniBugAwayLogoImg.onerror = function() {
                        this.style.display = 'none';
                      };
                      miniBugAwayLogoImg.onload = function() {
                        this.style.display = 'block';
                      };
                      miniBugAwayLogoImg.src = data.awayLogo;
                      miniBugAwayLogoImg.style.display = 'block';
                    } else {
                      miniBugAwayLogoImg.src = '';
                      miniBugAwayLogoImg.style.display = 'none';
                    }
                  }
                }

                // Global ticker state
                let tickerLines = [
                  { text: "" },
                  { text: "" },
                  { text: "" },
                  { text: "" },
                  { text: "" }
                ];
                let currentTickerIndex = 0;
                let tickerRotationInterval = null;
                let tickerInitialized = false;

                // Score tracking for animations
                let lastHomeScore = 0;
                let lastAwayScore = 0;
                let currentHomeScore = null; // Initialize as null to detect first load
                let currentAwayScore = null; // Initialize as null to detect first load
                let currentMiniBugHomeScore = null; // Initialize as null to detect first load
                let currentMiniBugAwayScore = null; // Initialize as null to detect first load

                // Animation state flags to prevent premature updates
                let homeScoreAnimating = false;
                let awayScoreAnimating = false;
                let miniBugHomeScoreAnimating = false;
                let miniBugAwayScoreAnimating = false;

                // Flag animation tracking
                let lastFlagTrigger = null;

                function triggerScoreAnimation(team, teamColor, teamLogo, scoreIncrease) {
                  // Check if this is a touchdown (6 points in football mode)
                  const data = JSON.parse(localStorage.getItem('basketballScoreboard') || '{}');
                  if (data.selectedSport === 'football' && scoreIncrease === 6) {
                    triggerTouchdownOverlay(teamColor);
                  }

                  // Main scorebar animation
                  const scoreOverlay = document.getElementById(team + 'ScoreOverlay');
                  const scoreOverlayImg = document.getElementById(team + 'ScoreOverlayImg');

                  if (scoreOverlay && scoreOverlayImg) {
                    scoreOverlay.style.backgroundColor = teamColor;
                    if (teamLogo) {
                      scoreOverlayImg.src = teamLogo;
                      scoreOverlayImg.style.display = 'block';
                    } else {
                      scoreOverlayImg.style.display = 'none';
                    }

                    scoreOverlay.classList.remove('animate');
                    void scoreOverlay.offsetWidth; // Force reflow
                    scoreOverlay.classList.add('animate');

                    setTimeout(() => {
                      scoreOverlay.classList.remove('animate');
                    }, 1000);
                  }

                  // Mini bug animation
                  const miniBugOverlay = document.getElementById('miniBug' + team.charAt(0).toUpperCase() + team.slice(1) + 'ScoreOverlay');
                  const miniBugOverlayImg = document.getElementById('miniBug' + team.charAt(0).toUpperCase() + team.slice(1) + 'ScoreOverlayImg');

                  if (miniBugOverlay && miniBugOverlayImg) {
                    miniBugOverlay.style.backgroundColor = teamColor;
                    if (teamLogo) {
                      miniBugOverlayImg.src = teamLogo;
                      miniBugOverlayImg.style.display = 'block';
                    } else {
                      miniBugOverlayImg.style.display = 'none';
                    }

                    miniBugOverlay.classList.remove('animate');
                    void miniBugOverlay.offsetWidth; // Force reflow
                    miniBugOverlay.classList.add('animate');

                    setTimeout(() => {
                      miniBugOverlay.classList.remove('animate');
                    }, 1000);
                  }
                }

                function triggerTouchdownOverlay(teamColor) {
                  const touchdownOverlay = document.getElementById('touchdownOutput');
                  const touchdownLogoLeft = document.getElementById('touchdownLogoLeft');
                  const flagOverlay = document.getElementById('flagOverlay');

                  // Store current flag state before touchdown animation
                  const flagWasVisible = flagCurrentlyVisible;
                  const currentFlagTransform = flagOverlay ? flagOverlay.style.transform : 'scale(0.8)';

                  if (touchdownOverlay) {
                    // Get current data to determine which team scored
                    const data = JSON.parse(localStorage.getItem('basketballScoreboard') || '{}');

                    // Update the background to use the scoring team's color
                    if (teamColor) {
                      // Set the CSS variable for the background color
                      document.documentElement.style.setProperty('--touchdown-background-color', teamColor);
                    } else {
                      // Fallback to default orange gradient
                      document.documentElement.style.setProperty('--touchdown-background-color', 'linear-gradient(135deg, #ff6b00, #ff4500)');
                    }

                    // Set the CSS variable for the stroke color
                    if (teamColor) {
                      document.documentElement.style.setProperty('--touchdown-stroke-color', teamColor);
                    } else {
                      document.documentElement.style.setProperty('--touchdown-stroke-color', 'blue'); // Fallback stroke color
                    }

                    // Set team logo on left side only
                    if (touchdownLogoLeft) {
                      // Determine which team scored based on color match
                      let scoringTeamLogo = '';
                      if (teamColor === data.homeBgColor && data.homeLogo) {
                        scoringTeamLogo = data.homeLogo;
                      } else if (teamColor === data.awayBgColor && data.awayLogo) {
                        scoringTeamLogo = data.awayLogo;
                      }

                      if (scoringTeamLogo) {
                        touchdownLogoLeft.src = scoringTeamLogo;
                        touchdownLogoLeft.style.display = 'block';
                      } else {
                        touchdownLogoLeft.style.display = 'none';
                      }
                    }

                    touchdownOverlay.classList.remove('animate');
                    void touchdownOverlay.offsetWidth; // Force reflow
                    touchdownOverlay.classList.add('animate');

                    setTimeout(() => {
                      touchdownOverlay.classList.remove('animate');

                      // After touchdown animation ends, restore flag to its exact previous state
                      if (flagOverlay && flagWasVisible) {
                        flagOverlay.style.transform = currentFlagTransform;
                        if (!flagOverlay.classList.contains('animate')) {
                          flagOverlay.classList.add('animate');
                        }
                      }
                    }, 3000);
                  }
                }

                function updateTickerData(data) {
                  const tickerContainer = document.querySelector('.ticker-container');
                  const scrollingTextEl = document.getElementById('tickerScrollingText');

                  // Load custom ticker lines from data
                  if (data.customTickerLines && Array.isArray(data.customTickerLines) && data.customTickerLines.length > 0) {
                    tickerLines = data.customTickerLines;
                  } else {
                    // Fallback to default lines if no custom lines exist
                    tickerLines = [
                      { text: "" },
                      { text: "" },
                      { text: "" },
                      { text: "" },
                      { text: "" }
                    ];
                  }

                  // Handle ticker visibility
                  const tickerVisible = data.tickerVisible !== false; // default to visible

                  if (tickerVisible) {
                    if (tickerContainer) tickerContainer.classList.remove('hidden');

                    // Only start ticker rotation once
                    if (!tickerInitialized) {
                      startTickerRotation(scrollingTextEl);
                      tickerInitialized = true;
                    }

                    if (data.tickerLogo) {
                      const tickerLogoImg = document.getElementById('tickerLogo');
                      if (tickerLogoImg) {
                        tickerLogoImg.onerror = function() {
                          this.style.display = 'none';
                        };
                        tickerLogoImg.onload = function() {
                          this.style.display = 'block';
                        };
                        tickerLogoImg.src = data.tickerLogo;
                      }
                    }
                  } else {
                    if (tickerContainer) tickerContainer.classList.add('hidden');
                    stopTickerRotation();
                    tickerInitialized = false;
                    return;
                  }
                }

                function updateLeftSlabVisibility(data) {
                  const leftSlab = document.querySelector('.left-slab');
                  const leftSlabSeparator = document.querySelector('.left-slab-separator');
                  const isVisible = data.leftSlabVisible === true;

                  if (isVisible) {
                    if (leftSlab) leftSlab.classList.remove('hidden');
                    if (leftSlabSeparator) leftSlabSeparator.classList.remove('hidden');
                    updateLeftSlabSections(data);
                  } else {
                    if (leftSlab) leftSlab.classList.add('hidden');
                    if (leftSlabSeparator) leftSlabSeparator.classList.add('hidden');
                    hideAllLeftSlabSections();
                  }
                }

                function updateLeftSlabSections(data) {
                  const container = document.getElementById('leftSlabSectionsContainer');
                  if (!container) return;

                  // Clear existing sections
                  container.innerHTML = '';

                  let currentTopPosition = 20; // Start position for content - moved closer to top

                  // Add titles at the top if they exist
                  if (data.leftSlabTitle && data.leftSlabTitle.trim()) {
                    const titleElement = document.createElement('div');
                    titleElement.className = 'left-slab-title';
                    titleElement.style.cssText = `
                      position: absolute;
                      left: 50px;
                      top: ${currentTopPosition}px;
                      width: 300px;
                      color: #fff;
                      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                      font-size: 42px;
                      font-weight: 600;
                      text-transform: uppercase;
                      letter-spacing: 2px;
                      z-index: 10003;
                      pointer-events: none;
                      transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                      margin-bottom: 5px;
                    `;
                    titleElement.textContent = data.leftSlabTitle;
                    container.appendChild(titleElement);

                    // Adjust starting position for second title
                    currentTopPosition += 45; // Reduced spacing to bring 2nd title closer
                  }

                  if (data.leftSlabTitle2 && data.leftSlabTitle2.trim()) {
                    const title2Element = document.createElement('div');
                    title2Element.className = 'left-slab-title-2';
                    title2Element.style.cssText = `
                      position: absolute;
                      left: 50px;
                      top: ${currentTopPosition}px;
                      width: 300px;
                      color: #fff;
                      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                      font-size: 28px;
                      font-weight: 600;
                      text-transform: uppercase;
                      letter-spacing: 2px;
                      z-index: 10003;
                      pointer-events: none;
                      transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.5s ease;
                      margin-bottom: 20px;
                    `;
                    title2Element.textContent = data.leftSlabTitle2;
                    container.appendChild(title2Element);

                    // Adjust starting position for sections
                    currentTopPosition += 45; // Adjust based on second title height
                  } else if (data.leftSlabTitle && data.leftSlabTitle.trim()) {
                    // If only first title exists, add extra spacing
                    currentTopPosition += 35;
                  }

                  // Display sections from the leftSlabSections array with dynamic positioning
                  if (data.leftSlabSections && Array.isArray(data.leftSlabSections)) {
                    let sectionTopPosition = currentTopPosition;

                    data.leftSlabSections.forEach((section, index) => {
                      // Skip empty sections
                      if (!section.title) return;

                      const sectionElement = document.createElement('div');
                      sectionElement.className = 'left-slab-section';
                      sectionElement.style.left = '50px';
                      sectionElement.style.top = `${sectionTopPosition}px`;
                      sectionElement.style.width = '300px';
                      sectionElement.style.height = 'auto';
                      sectionElement.style.minHeight = '60px';
                      sectionElement.style.padding = '15px';
                      sectionElement.style.lineHeight = '1.4';
                      sectionElement.style.visibility = 'hidden'; // Hide initially to measure

                      // Create content with title only
                      let content = '';
                      if (section.title) {
                        content += `<div style="font-size: 14px; font-weight: bold; text-transform: uppercase;">${section.title}</div>`;
                      }

                      sectionElement.innerHTML = content;
                      container.appendChild(sectionElement);

                      // Force layout calculation and measure actual height
                      sectionElement.offsetHeight; // Force reflow
                      const actualHeight = sectionElement.offsetHeight;

                      // Make element visible again
                      sectionElement.style.visibility = 'visible';

                      // Update position for next section (actual height + 15px gap)
                      sectionTopPosition += actualHeight + 15;
                    });
                  }
                }

                function hideAllLeftSlabSections() {
                  const sections = document.querySelectorAll('.left-slab-section');
                  sections.forEach(section => {
                    section.classList.add('hidden');
                  });
                }

                function startTickerRotation(scrollingTextEl) {
                  if (!scrollingTextEl || tickerLines.length === 0) return;

                  // Set initial ticker text
                  currentTickerIndex = 0;
                  scrollingTextEl.textContent = tickerLines[currentTickerIndex].text;

                  // If we have multiple lines, set up rotation
                  if (tickerLines.length > 1) {
                    // Each animation cycle is 25 seconds, so rotate after each complete cycle
                    tickerRotationInterval = setInterval(() => {
                      currentTickerIndex = (currentTickerIndex + 1) % tickerLines.length;
                      scrollingTextEl.textContent = tickerLines[currentTickerIndex].text;
                    }, 25000); // Match the animation duration
                  }
                }

                function stopTickerRotation() {
                  if (tickerRotationInterval) {
                    clearInterval(tickerRotationInterval);
                    tickerRotationInterval = null;
                  }
                }

                function updateFootballData(data) {
                  const footballDownEl = document.getElementById('footballDown');
                  const footballToGoEl = document.getElementById('footballToGo');
                  const footballSection = document.getElementById('footballSection');
                  const footballSectionSeparator = document.getElementById('footballSectionSeparator');
                  const footballCombined = document.getElementById('footballCombined');

                  if (footballDownEl && data.footballDown) {
                    footballDownEl.textContent = data.footballDown;
                  }
                  if (footballToGoEl && typeof data.footballYardsToGo === 'number') {
                    footballToGoEl.textContent = data.footballYardsToGo;
                  }

                  // Handle football section visibility
                  const isFootball = data.selectedSport === 'football';
                  const footballSectionVisible = data.footballSectionVisible !== false; // default to visible
                  const footballTextVisible = data.footballTextVisible !== false; // default to visible

                  if (isFootball && footballSectionVisible) {
                    if (footballSection) footballSection.style.display = 'flex';
                    if (footballSectionSeparator) footballSectionSeparator.style.display = 'block';

                    // Handle text visibility within the section
                    if (footballCombined) {
                      if (footballTextVisible) {
                        footballCombined.classList.remove('hidden');
                      } else {
                        footballCombined.classList.add('hidden');
                      }
                    }
                  } else {
                    if (footballSection) footballSection.style.display = 'none';
                    if (footballSectionSeparator) footballSectionSeparator.style.display = 'none';
                  }
                }

                function updateVolleyballSets(data) {
                  const volleyballSetSection = document.getElementById('volleyballSetSection');
                  const volleyballSetDisplay = document.getElementById('volleyballSetDisplay');
                  if (volleyballSetDisplay && data.volleyballSet) {
                    volleyballSetDisplay.textContent = `Set ${data.volleyballSet}/5`;
                  }
                }

                function updateSportMode(data) {
                  const scorebar = document.querySelector('.scorebar');
                  const isFootball = data.selectedSport === 'football';
                  const isVolleyball = data.selectedSport === 'volleyball';

                  if (isFootball) {
                    if (scorebar) {
                      scorebar.classList.add('football-mode');
                      scorebar.classList.remove('volleyball-mode');
                    }
                  } else if (isVolleyball) {
                    if (scorebar) {
                      scorebar.classList.add('volleyball-mode');
                      scorebar.classList.remove('football-mode');
                    }
                  } else {
                    if (scorebar) {
                      scorebar.classList.remove('football-mode', 'volleyball-mode');
                    }
                  }
                }

                function updateFullscreenSquareVisibility(data) {
                  const fullscreenSquare = document.getElementById('fullscreenSquare');
                  const fullscreenLeftSeparator = document.getElementById('fullscreenLeftSeparator');
                  const fullscreenRightSeparator = document.getElementById('fullscreenRightSeparator');
                  const isVisible = data.fullscreenVisible === true;

                  if (fullscreenSquare) {
                    if (isVisible) {
                      fullscreenSquare.classList.add('visible');
                      if (fullscreenLeftSeparator) fullscreenLeftSeparator.classList.add('visible');
                      if (fullscreenRightSeparator) fullscreenRightSeparator.classList.add('visible');
                    } else {
                      fullscreenSquare.classList.remove('visible');
                      if (fullscreenLeftSeparator) fullscreenLeftSeparator.classList.remove('visible');
                      if (fullscreenRightSeparator) fullscreenRightSeparator.classList.remove('visible');
                    }
                  }
                }

                // initial run
                document.addEventListener('DOMContentLoaded', updateScoreboardFromStorage);

                window.addEventListener('storage', e => {
                  if (e.key === 'basketballScoreboard') {
                    updateScoreboardFromStorage();
                  }
                });

                window.addEventListener('focus', updateScoreboardFromStorage);

                // Listen for IPC scoreboard state updates (Electron only)
                if (window.api && window.api.on) {
                  window.api.on('scoreboard-state-update', (state) => {
                    console.log('[STAT DEBUG] Received state update via IPC:', {
                      hasStatDisplayVisible: 'statDisplayVisible' in state,
                      statDisplayVisible: state.statDisplayVisible,
                      currentDisplayedStat: state.currentDisplayedStat,
                      hasFootballStats: !!state.footballStats
                    });
                    // Save to localStorage so regular update function can use it
                    localStorage.setItem('basketballScoreboard', JSON.stringify(state));
                    // Trigger update
                    updateScoreboardFromStorage();
                  });
                }

                // Auto-refresh for OBS compatibility - check for updates every 50ms for faster updates
                // Allow custom refresh rate via URL parameter: ?refresh=250 (for 250ms)
                const urlParams = new URLSearchParams(window.location.search);
                const refreshRate = parseInt(urlParams.get('refresh')) || 16;

                async function checkForUpdatesAndRefresh() {
                  await updateScoreboardFromStorage();
                }

                setInterval(checkForUpdatesAndRefresh, refreshRate);
              </script>

              </body>
              </html>
